!function(H,t,o,y){var _=y,T=y,s=!1,i=y,m=0,u=y,w=y,a="drag",r={id:96,editor:{selected_shape:"rect-3198"},general:{name:"TourDemo",width:800,height:450,naturalWidth:800,naturalHeight:450},image:{},tooltips:{show_title_on_mouseover:1},layers:{layers_list:[{id:0,title:"Main Floor",image_url:"https://webcraftplugins.com/uploads/image-map-pro/demo.jpg",image_width:1280,image_height:776}]},spots:[{id:"rect-3198",title:"rect-3198",type:"rect",x:9.375,y:60.667,width:16.5,height:26,x_image_background:9.375,y_image_background:60.667,width_image_background:16.5,height_image_background:26,default_style:{border_radius:10,background_opacity:0,border_width:2,border_style:"dashed",border_color:"#000000"},mouseover_style:{border_radius:10},tooltip_style:{width:150,auto_width:0},tooltip_content:{squares_settings:{containers:[{id:"sq-container-305521",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}}},{id:"oval-3529",title:"oval-3529",type:"oval",x:79.875,y:14.223,width:12.25,height:20.667,x_image_background:79.875,y_image_background:14.223,width_image_background:12.25,height_image_background:20.667,default_style:{background_opacity:0},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}}},{id:"oval-9040",title:"oval-9040",type:"oval",x:77.75,y:42.667,width:15.5,height:22.889,x_image_background:77.75,y_image_background:42.667,width_image_background:15.5,height_image_background:22.889,default_style:{background_opacity:0},tooltip_content:{squares_settings:{containers:[{id:"sq-container-403761",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"}}]}}]}}}]},n=y,S=H.imageMapProEditorDefaults,f=H.imageMapProShapeDefaults;function l(){this.wcpEditorSettings=y,this.actionStack=new Array,this.actionIndex=0,this.canvasImage=new Image,this.canvasWidth=0,this.canvasHeight=0,this.canvas=y,this.ix=0,this.iy=0,this.x=0,this.y=0,this.dx=0,this.dy=0,this.ixss=0,this.iyss=0,this.xss=0,this.yss=0,this.dxss=0,this.dyss=0,this.drawRectWidth=0,this.drawRectHeight=0,this.transformX=0,this.transformY=0,this.transformWidth=0,this.transformHeight=0,this.eventSpotId=y,this.redrawEl=y,this.redrawSvgEl=y,this.redrawPolygonEl=y,this.redrawElBgImage=y,this.redrawTooltip=y,this.tempControlPoint=y,this.tempControlPointLine=y,this.tempControlPointIndex=y,this.controlPointInsertionPointX=0,this.controlPointInsertionPointY=0,this.translatedPointIndex=0,this.translatedPoint=y,this.translatedPointX=0,this.translatedPointY=0,this.polyPoints=new Array,this.canvasInitialX=0,this.canvasInitialY=0,this.movingTooltipShapeCenterX=0,this.movingTooltipShapeCenterY=0,this.movingTooltipCenterX=0,this.movingTooltipCenterY=0,this.movingTooltipPosition=y,this.movingTooltipColorRGBA=y,this.movingTooltipArrow=y,this.transformingTooltipStartingWidth=0,this.transformingTooltipWidth=0,this.startedSelecting=!1,this.startedMoving=!1,this.startedTransforming=!1,this.didTransforming=!1,this.transformDirection=0,this.startedTransformingTooltip=!1,this.didTransformTooltip=!1,this.startedDrawingSpot=!1,this.startedDrawingText=!1,this.startedDrawingRect=!1,this.createdDrawingRect=!1,this.startedDrawingOval=!1,this.createdDrawingOval=!1,this.startedDrawingPoly=!1,this.drawingPoly=!1,this.finishedDrawingPoly=!1,this.mouseDownWhileDrawingPoly=!1,this.startedTranslatingControlPoint=!1,this.translatingControlPoint=!1,this.didDeleteControlPoint=!1,this.shouldDeselectShape=!1,this.ctrlKeyDown=!1,this.altKeyDown=!1,this.shiftKeyDown=!1,this.spaceKeyDown=!1,this.commandKeyDown=!1,this.draggingCanvas=!1,this.startedSelectingTooltip=!1,this.movingTooltip=!1,this.selectedSpot=y,this.eventSpot=y,this.shapesFormSpotIndex=y,this.iconsHTML=H.wcpFontawesomeUI,this.zoom=1,this.canvasX=0,this.canvasY=0}function p(t,e,o,i){t.complete&&t.naturalWidth!==y&&t.naturalHeight!==y?o():(e(),H(t).on("load",function(){H(t).off("load"),o()}),H(t).on("error",function(){H(t).off("error"),i()}))}function E(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}}function P(t,e,o){return{x:Math.round(1e3*(t-o.offset().left))/1e3,y:Math.round(1e3*(e-o.offset().top))/1e3}}function W(t,e){return{x:e.width*(t.x/100)+e.x,y:e.height*(t.y/100)+e.y}}function D(t,e){return t<0&&(t=0),100<t&&(t=100),e<0&&(e=0),100<e&&(e=100),{x:Math.round(1e3*t)/1e3,y:Math.round(1e3*e)/1e3}}function z(t){return 1==parseInt(t,10)}function b(t,e){this.x=t,this.y=e}H.imageMapProDefaultSettings=H.extend(!0,{},S),H.imageMapProDefaultSpotSettings=H.extend(!0,{},f),H.squaresExtendElementDefaults({defaultControls:{font:{text_color:{name:"Text Color",type:"color",default:"#ffffff"}}}}),H.squaresUpdatedContent=function(t){_.selectedSpot&&(_.selectedSpot.tooltip_content.squares_settings=t),_.addAction()},H.image_map_pro_default_spot_settings=function(){return f},H.image_map_pro_init_editor=function(t,e){(_=new l).init(t,e)},H.image_map_pro_editor_current_settings=function(){return T},H.image_map_pro_editor_compressed_settings=function(){return _.getCompressedSettings()},H.image_map_pro_user_uploaded_image=function(){},H.wcpEditorSliderStartedDragging=function(){s=!0},H.wcpEditorSliderFinishedDragging=function(){s=!1},H.wcpTourCoordinatesForTipForStep=function(t){return"Drawing Shapes"==t?{x:H("#wcp-editor-toolbar-wrap").offset().left+H("#wcp-editor-toolbar-wrap").width()+20,y:H("#wcp-editor-toolbar-wrap").offset().top+H("#wcp-editor-toolbar-wrap").height()/3}:"Customize Your Shapes"==t?{x:H("#wcp-editor-object-settings").offset().left-20,y:H("#wcp-editor-object-settings").offset().top+40}:"Edit and Delete Shapes"==t?{x:H("#wcp-editor-object-list-wrap").offset().left-20,y:H("#wcp-editor-object-list-wrap").offset().top+50}:"Edit the Tooltips"==t?{x:H("#imp-editor-tooltip-bar-wrap").offset().left-20,y:H("#imp-editor-tooltip-bar-wrap").offset().top+10}:"Image Map Settings"==t?{x:H("#wcp-editor-button-settings").offset().left+H("#wcp-editor-button-settings").outerWidth()+20,y:H("#wcp-editor-button-settings").offset().top+H("#wcp-editor-button-settings").outerHeight()/2}:"Responsive &amp; Fullscreen Tooltips"==t?{x:H('[data-wcp-main-tab-button-name="Image Map"]').offset().left+150,y:H('[data-wcp-main-tab-button-name="Image Map"]').offset().top+40}:"Preview Mode"==t?{x:H("#wcp-editor-button-preview").offset().left-20,y:H("#wcp-editor-button-preview").offset().top+32}:"Save and Load"==t?{x:H("#wcp-editor-button-load").offset().left+64,y:H("#wcp-editor-button-load").offset().top+32}:"Publish"==t?{x:H("#wcp-editor-button-settings").offset().left+H("#wcp-editor-button-settings").outerWidth()+20,y:H("#wcp-editor-button-settings").offset().top+H("#wcp-editor-button-settings").outerHeight()/2}:"Import and Export"==t?{x:H('[data-wcp-editor-main-button-name="import"]').offset().left-20,y:H('[data-wcp-editor-main-button-name="import"]').offset().top+32}:"Easy Installation"==t?{x:H('[data-wcp-editor-main-button-name="code"]').offset().left-20,y:H('[data-wcp-editor-main-button-name="code"]').offset().top+32}:void 0},H.wcpTourCoordinatesForHighlightRect=function(t){return"Drawing Shapes"==t?{x:H("#wcp-editor-toolbar-wrap").offset().left,y:H(".wcp-editor-toolbar").first().offset().top,width:H("#wcp-editor-toolbar-wrap").outerWidth(),height:H(".wcp-editor-toolbar").last().offset().top-H(".wcp-editor-toolbar").first().offset().top+H(".wcp-editor-toolbar").last().outerHeight()}:"Customize Your Shapes"==t?{x:H("#wcp-editor-object-settings").offset().left,y:H("#wcp-editor-object-settings").offset().top,width:H("#wcp-editor-object-settings").outerWidth(),height:H("#wcp-editor-object-settings").outerHeight()}:"Edit and Delete Shapes"==t?{x:H("#wcp-editor-object-list-wrap").offset().left,y:H("#wcp-editor-object-list-wrap").offset().top,width:H("#wcp-editor-object-list-wrap").outerWidth(),height:H("#wcp-editor-object-list-wrap").outerHeight()}:"Edit the Tooltips"==t?{x:H("#imp-editor-tooltip-bar-wrap").offset().left,y:H("#imp-editor-tooltip-bar-wrap").offset().top,width:H("#imp-editor-tooltip-bar-wrap").outerWidth(),height:H("#imp-editor-tooltip-bar-wrap").outerHeight()}:"Image Map Settings"==t?{x:H("#wcp-editor-button-settings").offset().left,y:H("#wcp-editor-button-settings").offset().top,width:H("#wcp-editor-button-settings").outerWidth(),height:H("#wcp-editor-button-settings").outerHeight()}:"Responsive &amp; Fullscreen Tooltips"==t?{x:H('[data-wcp-main-tab-button-name="Image Map"]').offset().left,y:H('[data-wcp-main-tab-button-name="Image Map"]').offset().top,width:H('[data-wcp-main-tab-button-name="Image Map"]').outerWidth(),height:H('[data-wcp-main-tab-button-name="Image Map"]').outerHeight()}:"Preview Mode"==t?{x:H("#wcp-editor-button-preview").offset().left,y:H("#wcp-editor-button-preview").offset().top,width:H("#wcp-editor-button-preview").outerWidth(),height:H("#wcp-editor-button-preview").outerHeight()}:"Save and Load"==t?{x:H("#wcp-editor-button-save").offset().left,y:H("#wcp-editor-button-save").offset().top,width:H("#wcp-editor-button-save").outerWidth()+H("#wcp-editor-button-load").outerWidth(),height:H("#wcp-editor-button-save").outerHeight()}:"Publish"==t?{x:H("#wcp-editor-button-settings").offset().left,y:H("#wcp-editor-button-settings").offset().top,width:H("#wcp-editor-button-settings").outerWidth(),height:H("#wcp-editor-button-settings").outerHeight()}:"Import and Export"==t?{x:H('[data-wcp-editor-main-button-name="import"]').offset().left,y:H('[data-wcp-editor-main-button-name="import"]').offset().top,width:H('[data-wcp-editor-main-button-name="import"]').outerWidth()+H('[data-wcp-editor-main-button-name="export"]').outerWidth(),height:H('[data-wcp-editor-main-button-name="import"]').outerHeight()}:"Easy Installation"==t?{x:H('[data-wcp-editor-main-button-name="code"]').offset().left,y:H('[data-wcp-editor-main-button-name="code"]').offset().top,width:H('[data-wcp-editor-main-button-name="code"]').outerWidth(),height:H('[data-wcp-editor-main-button-name="code"]').outerHeight()}:void 0},H.wcpTourEventStarted=function(){},H.wcpTourEventFinished=function(){},H.wcpTourEventStepWillChange=function(t){},H.wcpEditorGetContentForCanvas=function(){return""},H.wcpEditorGetListItems=function(){for(var t=[],e=T.spots.length-1;0<=e;e--){var o=T.spots[e];t.push({id:o.id,title:o.title})}return t},H.wcpEditorGetSaves=function(r){H.imp_editor_storage_get_saves_list(function(t){for(var e=new Array,o=0;o<t.length;o++){var i={};i=t[o].name?{name:t[o].name,id:t[o].id}:{name:"Untitled",id:t[o].id},e.push(i)}r(e)})},H.wcpEditorGetExportJSON=function(){return JSON.stringify(_.getCompressedSettings())},H.wcpEditorGetSettingsForm=function(){return H.wcpFormGenerateHTMLForForm("Image Map Settings")},H.wcpEditorGetSettingsFormTitle=function(){return"Image Map Settings"},H.wcpEditorEventNewButtonPressed=function(){var t={name:"create_new",title:"Create New",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"primary",title:"Create",class:"primary",id:"wcp-editor-button-create-new-instance"}],width:500,body:H.wcpFormGenerateHTMLForForm("New Image Map")};H.wcpEditorPresentModal(t),H.wcpFormUpdateForm("New Image Map"),_.updateNewImageMapFormState()},H.wcpEditorEventSaveButtonPressed=function(){H.wcpEditorPresentLoadingScreen("Saving..."),H.imp_editor_storage_store_save(_.getCompressedSettings(),function(t){if(t)H.wcpEditorHideLoadingScreenWithMessage("Saved!",!1,!1);else{H.wcpEditorHideLoadingScreenWithMessage("There was an error saving the image map!",!0,!1);var e="";e+='<div class="modal-info-text">Please save this code in order to preserve your work and try again later. <br>This code can be imported any time by opening an existing image map and pressing the Import button. <br>You can also <a href="https://webcraftplugins.com/support">contact us</a>!</div>',e+='<textarea id="textarea-error-saving">'+JSON.stringify(_.getCompressedSettings())+"</textarea>",setTimeout(function(){H.wcpEditorPresentModal({name:"error-saving",title:"Error Saving Image Map",buttons:[{class:"primary",name:"primary",title:"Done"}],body:e})},1e3)}})},H.wcpEditorEventLoadButtonPressed=function(){},H.wcpEditorEventUndoButtonPressed=function(){_.undo()},H.wcpEditorEventRedoButtonPressed=function(){_.redo()},H.wcpEditorEventPreviewButtonPressed=function(){H.wcpEditorIsFloatingWindowOpen()&&H.wcpEditorCloseFloatingWindow()},H.wcpEditorEventEnteredPreviewMode=function(){T.editor.previewMode=1,_.redraw()},H.wcpEditorEventExitedPreviewMode=function(){T.editor.previewMode=0,_.redraw()},H.wcpEditorEventListItemMouseover=function(t){for(var e=y,o=0;o<T.spots.length;o++)T.spots[o].id==t&&(e=T.spots[o].title),z(T.editor.previewMode)&&H.imageMapProUnhighlightShape(T.general.name,T.spots[o].title);z(T.editor.previewMode)&&H.imageMapProHighlightShape(T.general.name,e)},H.wcpEditorEventListItemSelected=function(t){_.selectSpot(t),_.redraw()},H.wcpEditorEventListItemMoved=function(t,e,o){o=T.spots.length-1-o,e=T.spots.length-1-e,o>T.spots.length-1&&(o=T.spots.length-1),T.spots.splice(o,0,T.spots.splice(e,1)[0]),_.updateShapesList(),_.redraw()},H.wcpEditorEventObjectListButtonPressed=function(t){if(_.selectedSpot){if("duplicate"==t){var e=H.extend(!0,{},_.selectedSpot);"spot"==e.type&&(e.id=_.createIdForSpot()),"rect"==e.type&&(e.id=_.createIdForRect()),"oval"==e.type&&(e.id=_.createIdForOval()),"poly"==e.type&&(e.id=_.createIdForPoly()),"text"==e.type&&(e.id=_.createIdForText()),e.title+=" Copy",T.spots.push(e),_.redraw(),_.addAction()}if("copy"==t&&(i={text:H.extend(!0,{},_.selectedSpot.text),default_style:H.extend(!0,{},_.selectedSpot.default_style),mouseover_style:H.extend(!0,{},_.selectedSpot.mouseover_style),tooltip_style:H.extend(!0,{},_.selectedSpot.tooltip_style)}),"paste"==t){var o=_.selectedSpot.text.text;_.selectedSpot.text=H.extend(!0,{},i.text),_.selectedSpot.default_style=H.extend(!0,{},i.default_style),_.selectedSpot.mouseover_style=H.extend(!0,{},i.mouseover_style),_.selectedSpot.tooltip_style=H.extend(!0,{},i.tooltip_style),_.selectedSpot.text.text=o,_.redraw(),_.addAction()}if("delete"==t&&(m=_.getIndexOfSpotWithId(_.selectedSpot.id),H.wcpEditorPresentModal({name:"confirm-delete-shape",title:"Confirm Delete",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"primary",title:"Delete",class:"danger"}],body:"Delete this shape?"})),"rename"==t){H.wcpEditorPresentModal({name:"confirm-rename-shape",title:"Rename Shape",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"primary",title:"Rename",class:"primary"}],body:'<div class="wcp-form-form-control"><label>Shape Name</label><input type="text" id="input-shape-name"></div><div class="modal-error-text" id="rename-shape-error" style="margin-top: 10px; display: none;"></div>'}),H("#input-shape-name").val(_.selectedSpot.title)}}},H.wcpEditorEventSelectedTool=function(t){T.editor.tool=t,_.redraw()},H.wcpEditorEventPressedTool=function(t){"reset"==t&&_.zoomReset()},H.wcpEditorEventMainButtonClick=function(t){if("code"==t){var e="";e+='<div id="imp-generated-code-wrap">',e+='<div class="generated-code-help">',e+="    This is a sample HTML document, showing how to install the plugin in your website.",e+="</div>",e+="<pre>",e+="&lt;!doctype html&gt;<br>",e+="&lt;html&gt;<br>",e+="&lt;head&gt;<br>",e+='    <strong><span class="em-code">&lt;link rel=&quot;stylesheet&quot; href=&quot;css/image-map-pro.min.css&quot;&gt;</span></strong><br>',e+="&lt;/head&gt;<br>",e+="&lt;body&gt;<br>",e+='    &lt;div id=&quot;<strong><span class="em-code">image-map-pro-container</span></strong>&quot;&gt;&lt;/div&gt;<br><br>',e+="    &lt;script src=&quot;js/jquery.min.js&quot;&gt;&lt;/script&gt;<br>",e+='    <strong><span class="em-code">&lt;script src=&quot;js/image-map-pro.min.js&quot;&gt;&lt;/script&gt;</span></strong><br>',e+="    &lt;script type=&quot;text/javascript&quot;&gt;<br>",e+="        ;(function ($, window, document, undefined) {<br>",e+="            $(document).ready(function() {<br>",e+="</pre>",e+='<div class="generated-code-help">The code that contains all settings and initializes the plugin:</div>',e+='<textarea id="textarea-generated-code" rows="4"></textarea>',e+="    <pre>",e+="            });<br>",e+="        })(jQuery, window, document);<br>",e+="    &lt;/script&gt;<br>",e+="&lt;/body&gt;<br>",e+="&lt;/html&gt;<br>",e+="</pre>",e+="</div>",H.wcpEditorPresentModal({name:"code",title:"Code",buttons:[{name:"primary",title:"Done",class:"primary"}],body:e}),H("#textarea-generated-code").val("$('#image-map-pro-container').imageMapPro("+JSON.stringify(_.getCompressedSettings())+");")}if("activate"==t){e='<div class="wcp-form-form-control">';e+='<label>Purchase Code <a href="https://help.market.envato.com/hc/en-us/articles/202822600-Where-Is-My-Purchase-Code-" target="_blank"><i class="fa fa-question-circle" aria-hidden="true" data-wcp-tooltip="Trouble finding your purchase code?" data-wcp-tooltip-position="right"></i></a></label>',e+='<input type="text" id="input-purchase-code">',e+="</div>",H.wcpEditorPresentModal({name:"activate",title:"Activate",buttons:[{name:"cancel",title:"Cancel",class:"default"},{name:"primary",title:"Activate",class:"primary"}],body:e})}if("help"==t&&(n=T,T=r,_.shapesFormSpotIndex=-1,_.parseSettings(),_.redraw(),H("#wcp-editor-main-buttons").addClass("wcp-expanded"),H.wcpTourEventFinished=function(){T=n,_.redraw()},H.wcpTourRestart("Image Map Pro Editor Tour")),"import"==t){H.wcpFormCreateForm({name:"Import",controls:[{label_width:104,name:"import_format",title:"Import Format",type:"button group",options:[{value:"imp_code",title:"Image Map Pro Code"},{value:"svg_code",title:"SVG XML Code"}],value:"imp_code"},{label_width:104,name:"code",title:"Paste code to import",type:"textarea",value:""},{type:"info",name:"invalid_code",title:"Invalid Code",value:"Invalid Code",options:{style:"red"}}]});var o={name:"import",title:"Import",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"primary",title:"Import",class:"primary",id:"wcp-editor-confirm-import"}],body:H.wcpFormGenerateHTMLForForm("Import"),width:700};H.wcpEditorPresentModal(o),H.wcpFormUpdateForm("Import"),H.wcpFormHideControl("Import","invalid_code")}},H.wcpEditorEventModalButtonClicked=function(t,e){if("create_new"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e))if(0==(c=H.wcpFormGetModel("New Image Map")).name&&(c.name="Untitled"),c.name=c.name.replace(/\W/g,""),(T=H.extend(!0,{},S)).id=Math.round(1e4*Math.random())+1,T.general.name=c.name,T.general.shortcode=c.name.replace(/[^\w]/g,""),H.wcpEditorCloseModal(),H.wcpEditorPresentLoadingScreen("Creating..."),"countries"==c.template)H.imageMapProCountriesGetCountrySVG(c.country,function(t){_.parseSVG(t);for(var e=0;e<T.spots.length;e++)T.spots[e].default_style.background_color="#0258CF",T.spots[e].default_style.background_opacity=1,T.spots[e].default_style.stroke_color="#ffffff",T.spots[e].default_style.stroke_width=1,T.spots[e].default_style.stroke_opacity=1,T.spots[e].mouseover_style.background_color="#00357D",T.spots[e].mouseover_style.background_opacity=1,T.spots[e].mouseover_style.stroke_color="#ffffff",T.spots[e].mouseover_style.stroke_width=1,T.spots[e].mouseover_style.stroke_opacity=1;T.tooltips.sticky_tooltips=1,H.imp_editor_storage_store_save(_.getCompressedSettings(),function(){H.imp_editor_storage_set_last_save(T.id,function(){_.launch(),H.wcpEditorHideLoadingScreenWithMessage("Created!",!1,!1)})})});else H.imp_editor_storage_store_save(_.getCompressedSettings(),function(){H.imp_editor_storage_set_last_save(T.id,function(){_.launch(),H.wcpEditorHideLoadingScreenWithMessage("Created!",!1,!1)})});if("modal-choose-icon"==t&&"cancel"==e&&H.wcpEditorCloseModal(),"load"==t&&"cancel"==e&&H.wcpEditorCloseModal(),"confirm-delete-shape"==t&&("primary"==e&&(T.editor.selected_shape==T.spots[m].id&&_.deselectSpot(),T.spots.splice(m,1),H.wcpEditorCloseModal(),_.redraw(),_.addAction()),"cancel"==e&&H.wcpEditorCloseModal()),"code"==t&&"primary"==e&&H.wcpEditorCloseModal(),"export"==t&&"primary"==e&&H.wcpEditorCloseModal(),"import"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e)){if("imp_code"==(c=H.wcpFormGetModel("Import")).import_format){var o=c.code,i=y;try{i=JSON.parse(o)}catch(t){console.log("error decoding JSON!")}if(i===y)H.wcpFormShowControl("Import","invalid_code");else{H.wcpEditorCloseModal(),H.wcpFormHideControl("Import","invalid_code");var r=T.general.name,s=T.id;(T=H.extend(!0,{},i)).general.name=r,T.id=s,_.launch()}}if("svg_code"==c.import_format){var a=H.extend(!0,{},T);H.wcpFormHideControl("Import","invalid_code");try{_.parseSVG(c.code),_.redraw(),H.wcpEditorCloseModal()}catch(t){T=H.extend(!0,{},a),H.wcpFormShowControl("Import","invalid_code")}}}if("error-saving"==t&&"primary"==e&&H.wcpEditorCloseModal(),"activate"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e&&(H.wcpEditorCloseModal(),H.wcpEditorPresentLoadingScreen("Validating Purchase Code..."),H.wcpValidatePurchaseCode?H.wcpValidatePurchaseCode(H("#input-purchase-code").val(),function(t,e){t?(H.wcpEditorHideLoadingScreenWithMessage("Success!",!1,!1),H.wcpEditorHideExtraMainButton("activate")):H.wcpEditorHideLoadingScreenWithMessage("Failed to validate your purchase code.",!0,!1)}):H.wcpEditorHideLoadingScreenWithMessage("Failed to validate your purchase code.</div>",!0,!0))),"confirm-rename-shape"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e)){var n=H("#input-shape-name").val();if(0==n.length)return void H("#rename-shape-error").show().html("Please enter a new name for the shape, or press Cancel.");for(var l=!1,p=0;p<T.spots.length;p++)if(T.spots[p].title==n&&T.spots[p].id!=_.selectedSpot.id){l=!0;break}if(l||0==n.length)return void H("#rename-shape-error").show().html("A shape with this name already exists!");_.selectedSpot.title=n,H.wcpEditorCloseModal(),_.redraw()}if("modal-add-layer"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e)){var d=!1;if(0==(c=H.wcpFormGetModel("New/Edit Layer")).name.length?(H.wcpFormSetErrorStateForControl("New/Edit Layer","name",!0),d=!0):H.wcpFormSetErrorStateForControl("New/Edit Layer","name",!1),0==c.url.length)return H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!0),void(d=!0);H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!1),_.processNewLayerImage(c.url,function(t,e,o){if(t?H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!1):(d=!0,H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!0)),!d){var i={id:_.createIdForLayer(),title:c.name,image_url:c.url,image_width:e,image_height:o};T.layers.layers_list.push(i),_.updateImageMapForm(),_.redraw(),H.wcpEditorCloseModal()}})}if("modal-edit-layer"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e)){var c;d=!1;if(0==(c=H.wcpFormGetModel("New/Edit Layer")).name.length?(H.wcpFormSetErrorStateForControl("New/Edit Layer","name",!0),d=!0):H.wcpFormSetErrorStateForControl("New/Edit Layer","name",!1),0==c.url.length)return H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!0),void(d=!0);H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!1),_.processNewLayerImage(c.url,function(t,e,o){if(t?H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!1):(d=!0,H.wcpFormSetErrorStateForControl("New/Edit Layer","url",!0)),!d){for(var i=0;i<T.layers.layers_list.length;i++)if(T.layers.layers_list[i].id==w){T.layers.layers_list[i].title=c.name,T.layers.layers_list[i].image_url=c.url,T.layers.layers_list[i].image_width=e,T.layers.layers_list[i].image_height=o;break}_.updateImageMapForm(),_.redraw(),H.wcpEditorCloseModal()}})}if("modal-confirm-delete-floor"==t&&("cancel"==e&&H.wcpEditorCloseModal(),"primary"==e)){if(1==T.layers.layers_list.length){H.wcpEditorCloseModal();return void H.wcpEditorPresentModal({name:"modal-delete-floor-error",title:"Error",buttons:[{name:"ok",title:"OK",class:"default",id:"imp-editor-button-delete-floor-error-ok"}],body:"Unable to delete, there is only one floor left."})}for(p=0;p<T.layers.layers_list.length;p++)T.layers.layers_list[p].id==u&&T.layers.layers_list.splice(p,1);T.editor.currentLayer=T.layers.layers_list[0].id;var h=[];for(p=0;p<T.spots.length;p++)if(T.spots[p].layerID!=u){var g=H.extend(!0,{},T.spots[p]);h.push(g)}T.spots=h,H.wcpEditorCloseModal(),_.updateImageMapForm(),_.updateShapesList(),_.redraw()}"modal-delete-floor-error"==t&&"ok"==e&&H.wcpEditorCloseModal()},H.wcpEditorEventModalClosed=function(t){},H.wcpEditorEventLoadSaveWithID=function(t){H.wcpEditorPresentLoadingScreen("Loading Image Map..."),H.imp_editor_storage_get_save(t,function(t){t?(T=t,H.imp_editor_storage_set_last_save(T.id,function(){H.wcpEditorHideLoadingScreen(),_.launch()})):H.wcpEditorHideLoadingScreenWithMessage("Error loading image map.",!0,!1)})},H.wcpEditorEventDeleteSaveWithID=function(t,e){H.imp_editor_storage_delete_save(t,function(){e()})},H.wcpEditorEventHelpButtonPressed=function(){},H.wcpFormEventFormUpdated=function(t){if("Image Map Settings"==t){var e=H.wcpFormGetModel(t);if(e.image.image_url&&0<e.image.image_url.length&&T.image.url!==e.image.image_url)T.image.url=e.image.image_url,_.canvasImage.src=e.image.image_url,p(_.canvasImage,function(){H.wcpEditorPresentLoadingScreen("Loading Image...")},function(){_.canvas_events(),H.wcpEditorHideLoadingScreen(),T.general.width=_.canvasImage.naturalWidth,T.general.height=_.canvasImage.naturalHeight,T.general.naturalWidth=_.canvasImage.naturalWidth,T.general.naturalHeight=_.canvasImage.naturalHeight,H.wcpFormSetControlValue("Image Map Settings","image_map_width",T.general.width),H.wcpFormSetControlValue("Image Map Settings","image_map_height",T.general.height),H.wcpFormUpdateForm("Image Map Settings"),_.redraw(),_.addAction()},function(){H.wcpEditorHideLoadingScreenWithMessage("Error Loading Image!",!0,!1)});else if(T.image.url!==e.image.image_url)T.image.url=e.image.image_url,_.canvasImage.src=e.image.image_url,_.canvas_events(),T.general.width=S.general.naturalWidth,T.general.height=S.general.naturalHeight,T.general.naturalWidth=S.general.naturalWidth,T.general.naturalHeight=S.general.naturalHeight,H.wcpFormSetControlValue("Image Map Settings","image_map_width",S.general.width),H.wcpFormSetControlValue("Image Map Settings","image_map_height",S.general.height),H.wcpFormUpdateForm("Image Map Settings"),_.redraw(),_.addAction();else{T.general.name=e.general.image_map_name.trim(),e.general.image_map_shortcode&&(T.general.shortcode=e.general.image_map_shortcode.replace(/[\[\]']+/g,"").trim()),T.general.width=e.general.image_map_width,T.general.height=e.general.image_map_height,T.general.responsive=e.general.responsive,T.general.preserve_quality=e.general.preserve_quality,T.general.center_image_map=e.general.center_image_map,T.image.url=e.image.image_url,T.shapes.pageload_animation=e.shapes.pageload_animation,T.shapes.glowing_shapes=e.shapes.glowing_shapes,T.shapes.glowing_shapes_color=e.shapes.glowing_shapes_color,T.shapes.glow_opacity=e.shapes.glow_opacity,T.shapes.stop_glowing_on_mouseover=e.shapes.stop_glowing_on_mouseover,T.tooltips.enable_tooltips=e.tooltips.enable_tooltips,T.tooltips.show_tooltips=e.tooltips.show_tooltips,T.tooltips.show_title_on_mouseover=e.tooltips.show_title_on_mouseover,T.tooltips.sticky_tooltips=e.tooltips.sticky_tooltips,T.tooltips.constrain_tooltips=e.tooltips.constrain_tooltips,T.tooltips.tooltip_animation=e.tooltips.tooltip_animation,T.tooltips.fullscreen_tooltips=e.tooltips.fullscreen_tooltips,T.fullscreen.enable_fullscreen_mode=e.fullscreen.enable_fullscreen_mode,T.fullscreen.start_in_fullscreen_mode=e.fullscreen.start_in_fullscreen_mode,T.fullscreen.fullscreen_background=e.fullscreen.fullscreen_background,T.fullscreen.fullscreen_button_position=e.fullscreen.fullscreen_button_position,T.fullscreen.fullscreen_button_type=e.fullscreen.fullscreen_button_type,T.fullscreen.fullscreen_button_color=e.fullscreen.fullscreen_button_color,T.fullscreen.fullscreen_button_text_color=e.fullscreen.fullscreen_button_text_color,T.zooming.enable_zooming=e.zooming.enable_zooming,T.zooming.max_zoom=e.zooming.max_zoom,T.zooming.limit_max_zoom_to_image_size=e.zooming.limit_max_zoom_to_image_size,T.zooming.enable_navigator=e.zooming.enable_navigator,T.zooming.enable_zoom_buttons=e.zooming.enable_zoom_buttons,T.zooming.zoom_button_text_color=e.zooming.zoom_button_text_color,T.zooming.zoom_button_background_color=e.zooming.zoom_button_background_color,T.zooming.hold_ctrl_to_zoom=e.zooming.hold_ctrl_to_zoom,T.layers.enable_layers=e.layers.enable_layers,T.layers.layers_list=e.layers.layers_list,z(T.layers.enable_layers)&&0==T.layers.layers_list.length&&(T.layers.layers_list=[{id:0,title:"Main Floor",image_url:T.image.url,image_width:T.general.width,image_height:T.general.height}],_.updateImageMapForm()),T.shapes_menu.enable_shapes_menu=e.shapes_menu.enable_shapes_menu,T.shapes_menu.detached_menu=e.shapes_menu.detached_menu,T.shapes_menu.menu_position=e.shapes_menu.menu_position,T.shapes_menu.enable_search=e.shapes_menu.enable_search,T.shapes_menu.group_by_floor=e.shapes_menu.group_by_floor,T.shapes_menu.hide_children_of_connected_shapes=e.shapes_menu.hide_children_of_connected_shapes;var o='<div data-imp-detached-menu="'+T.id+'"></div>';H.wcpFormSetControlValue("Image Map Settings","detached_menu_info",o),e.custom_code&&(T.custom_code.custom_css=e.custom_code.custom_css,T.custom_code.custom_js=e.custom_code.custom_js),_.redraw(),_.addAction()}}if("Shape Settings"==t&&_.selectedSpot!==y){var i=_.selectedSpot,r=H.wcpFormGetModel("Shape Settings");i.title=r.general.shape_title,i.x=r.general.x,i.y=r.general.y,i.width=r.general.width,i.height=r.general.height,i.connected_to=r.general.connected_to,i.use_connected_shape_tooltip=r.general.use_connected_shape_tooltip,i.static=r.general.static,i.text.text=r.text.text,i.text.font_family=r.text.font_family,i.text.font_size=r.text.font_size,i.text.font_weight=r.text.font_weight,i.text.text_color=r.text.text_color,i.text.text_opacity=r.text.text_opacity,i.actions.click=r.actions.click,i.actions.link=r.actions.link,i.actions.script=r.actions.script,i.actions.open_link_in_new_window=r.actions.open_link_in_new_window,i.default_style.opacity=r.default_style.opacity,i.default_style.icon_fill=r.default_style.icon_fill,i.default_style.border_radius=r.default_style.border_radius,i.default_style.background_type=r.default_style.background_type,i.default_style.background_image_url=r.default_style.background_image_url,i.default_style.background_image_opacity=r.default_style.background_image_opacity,i.default_style.background_image_scale=r.default_style.background_image_scale,i.default_style.background_image_offset_x=r.default_style.background_image_offset_x,i.default_style.background_image_offset_y=r.default_style.background_image_offset_y,i.default_style.background_color=r.default_style.background_color,i.default_style.background_opacity=r.default_style.background_opacity,i.default_style.border_width=r.default_style.border_width,i.default_style.border_style=r.default_style.border_style,i.default_style.border_color=r.default_style.border_color,i.default_style.border_opacity=r.default_style.border_opacity,i.default_style.stroke_color=r.default_style.stroke_color,i.default_style.stroke_opacity=r.default_style.stroke_opacity,i.default_style.stroke_width=r.default_style.stroke_width,i.default_style.stroke_dasharray=r.default_style.stroke_dasharray,i.default_style.stroke_linecap=r.default_style.stroke_linecap,i.default_style.use_icon=r.icon.use_icon,i.default_style.icon_type=r.icon.icon_type,i.default_style.icon_svg_path=r.icon.icon_svg_path,i.default_style.icon_svg_viewbox=r.icon.icon_svg_viewbox,i.default_style.icon_url=r.icon.icon_url,i.default_style.icon_is_pin=r.icon.icon_is_pin,i.default_style.icon_shadow=r.icon.icon_shadow,i.mouseover_style.opacity=r.mouseover_style.mouseover_opacity,i.mouseover_style.background_image_url=r.mouseover_style.mouseover_background_image_url,i.mouseover_style.background_image_opacity=r.mouseover_style.mouseover_background_image_opacity,i.mouseover_style.background_image_scale=r.mouseover_style.mouseover_background_image_scale,i.mouseover_style.background_image_offset_x=r.mouseover_style.mouseover_background_image_offset_x,i.mouseover_style.background_image_offset_y=r.mouseover_style.mouseover_background_image_offset_y,i.mouseover_style.background_color=r.mouseover_style.mouseover_background_color,i.mouseover_style.background_opacity=r.mouseover_style.mouseover_background_opacity,i.mouseover_style.icon_fill=r.mouseover_style.mouseover_icon_fill,i.mouseover_style.border_radius=r.mouseover_style.mouseover_border_radius,i.mouseover_style.border_width=r.mouseover_style.mouseover_border_width,i.mouseover_style.border_style=r.mouseover_style.mouseover_border_style,i.mouseover_style.border_color=r.mouseover_style.mouseover_border_color,i.mouseover_style.border_opacity=r.mouseover_style.mouseover_border_opacity,i.mouseover_style.stroke_color=r.mouseover_style.mouseover_stroke_color,i.mouseover_style.stroke_opacity=r.mouseover_style.mouseover_stroke_opacity,i.mouseover_style.stroke_width=r.mouseover_style.mouseover_stroke_width,i.mouseover_style.stroke_dasharray=r.mouseover_style.mouseover_stroke_dasharray,i.mouseover_style.stroke_linecap=r.mouseover_style.mouseover_stroke_linecap,i.tooltip.enable_tooltip=r.tooltip.enable_tooltip,_.redraw(),s||_.addAction()}if("Tooltip Style"==t&&_.selectedSpot!==y){i=_.selectedSpot,r=H.wcpFormGetModel("Tooltip Style");i.tooltip_style.border_radius=r.tooltip_border_radius,i.tooltip_style.padding=r.tooltip_padding,i.tooltip_style.background_color=r.tooltip_background_color,i.tooltip_style.background_opacity=r.tooltip_background_opacity,i.tooltip_style.position=r.tooltip_position,i.tooltip_style.width=r.tooltip_width,i.tooltip_style.auto_width=r.tooltip_auto_width,_.redraw(),s||_.addAction()}"New Image Map"==t&&_.updateNewImageMapFormState()},H.wcpEditorEventFloatingWindowClosed=function(t){"Tooltip Content"==t&&_.redraw()},H.wcpEditorSettingsWindowOpened=function(){_.redraw()},H.wcpEditorSettingsWindowClosed=function(){_.redraw()},l.prototype.init=function(t,e){var o=this;o.events(),o.wcpEditorSettings=e,T=H.extend(!0,{},S),H.wcpEditorWebsiteSettings?H.wcpTourIsFinished("Image Map Pro Editor Tour")?(T=H.wcpEditorWebsiteSettings(),o.launch()):(n=T,T=r,H.wcpEditorInit(this.wcpEditorSettings),_.shapesFormSpotIndex=-1,_.parseSettings(),_.redraw(),H("#wcp-editor-main-buttons").addClass("wcp-expanded"),H.wcpTourStart("Image Map Pro Editor Tour"),H.wcpTourEventFinished=function(t){"Image Map Pro Editor Tour"==t&&(T=H.wcpEditorWebsiteSettings(),o.launch())}):(H.wcpEditorInit(this.wcpEditorSettings),t?(T=t,o.launch()):H.imp_editor_storage_get_last_save(function(e){e?H.wcpTourIsFinished("Whats New 5.0")?(H.wcpEditorPresentLoadingScreen("Loading Image Map..."),H.imp_editor_storage_get_save(parseInt(e,10),function(t){t?(T=t,_.launch()):(H.wcpEditorHideLoadingScreenWithMessage("Error loading image map.",!0,!1),(T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch())})):(H.wcpTourStart("Whats New 5.0"),H.wcpTourEventFinished=function(t){"Whats New 5.0"==t&&(H.wcpEditorPresentLoadingScreen("Loading Image Map..."),H.imp_editor_storage_get_save(parseInt(e,10),function(t){t?(T=t,_.launch()):(H.wcpEditorHideLoadingScreenWithMessage("Error loading image map.",!0,!1),(T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch())}))}):H.imp_editor_storage_get_saves_list(function(t){0<t.length?H.wcpTourIsFinished("Whats New 5.0")?((T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch(),H.wcpEditorPresentLoadModal()):(H.wcpTourStart("Whats New 5.0"),H.wcpTourEventFinished=function(t){"Whats New 5.0"==t&&((T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch(),H.wcpEditorPresentLoadModal())}):H.wcpTourIsFinished("Image Map Pro Editor Tour")?(H.wcpTourDisable("Whats New 5.0"),(T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch()):(n=T,T=r,_.shapesFormSpotIndex=-1,_.parseSettings(),_.redraw(),H("#wcp-editor-main-buttons").addClass("wcp-expanded"),H.wcpTourStart("Image Map Pro Editor Tour"),H.wcpTourEventFinished=function(t){"Image Map Pro Editor Tour"==t&&((T=H.extend(!0,{},S)).general.name="Untitled",T.id=Math.round(1e4*Math.random())+1,o.launch())})})}))},l.prototype.launch=function(){var t=this;H.wcpEditorInit(this.wcpEditorSettings),H("#wcp-editor-canvas").attr("data-editor-object-type","0"),this.selectedSpot=y,this.eventSpot=y,this.shapesFormSpotIndex=y,this.parseSettings(),T.image.url&&0<T.image.url.length||z(T.layers.enable_layers)&&0<T.layers.layers_list.length?(z(T.layers.enable_layers)&&0<T.layers.layers_list.length?this.canvasImage.src=T.layers.layers_list[0].image_url:this.canvasImage.src=T.image.url,p(this.canvasImage,function(){H.wcpEditorPresentLoadingScreen("Loading Image...")},function(){t.canvas_events(),T.general.naturalWidth=t.canvasImage.naturalWidth,T.general.naturalHeight=t.canvasImage.naturalHeight,T.editor.state={dragging:!1,canvasX:0,canvasY:0,canvasZoom:1},t.redraw(),t.selectSpot(T.editor.selected_shape),H.wcpEditorHideLoadingScreen()},function(){H.wcpEditorHideLoadingScreenWithMessage("Error Loading Image!",!0,!1)})):(t.canvas_events(),T.editor.state={dragging:!1,canvasX:0,canvasY:0,canvasZoom:1},t.redraw(),t.selectSpot(T.editor.selected_shape),H.wcpEditorHideLoadingScreen()),this.actionIndex=-1,this.actionStack=new Array,this.addAction(),this.canvas=H("#wcp-editor-canvas"),H.wcpEditorSelectTool(T.editor.tool),this.updateImageMapForm(),H.wcpEditorModifyForPublish&&H.wcpEditorModifyForPublish()},l.prototype.parseSettings=function(){for(var t=0;t<T.spots.length;t++){if(T.spots[t]=H.extend(!0,{},f,T.spots[t]),-1!=T.spots[t].x_image_background&&-1!=T.spots[t].y_image_background||(T.spots[t].x_image_background=T.spots[t].x,T.spots[t].y_image_background=T.spots[t].y,T.spots[t].width_image_background=T.spots[t].width,T.spots[t].height_image_background=T.spots[t].height),"poly"==T.spots[t].type&&(T.spots[t].default_style.fill&&(T.spots[t].default_style.background_color=T.spots[t].default_style.fill,T.spots[t].default_style.fill=y),T.spots[t].default_style.fill_opacity&&(T.spots[t].default_style.background_opacity=T.spots[t].default_style.fill_opacity,T.spots[t].default_style.fill_opacity=y)),T.spots[t].tooltip_content.title||T.spots[t].tooltip_content.text){var e="";T.spots[t].tooltip_content.title&&(e+="<h3>"+T.spots[t].tooltip_content.title+"</h3>"),T.spots[t].tooltip_content.text&&(e+="<p>"+T.spots[t].tooltip_content.text+"</p>"),T.spots[t].tooltip_content.plain_text=e,T.spots[t].tooltip_content={content_type:T.spots[t].tooltip_content.content_type,plain_text:T.spots[t].tooltip_content.plain_text,plain_text_color:T.spots[t].tooltip_content.plain_text_color,squares_json:T.spots[t].tooltip_content.squares_json}}if(T.spots[t].tooltip_content.squares_json)try{T.spots[t].tooltip_content.squares_settings=JSON.parse(T.spots[t].tooltip_content.squares_json),T.spots[t].tooltip_content.squares_json=""}catch(t){}T.spots[t].title||(T.spots[t].title=T.spots[t].id),"show-tooltip"==T.spots[t].actions.click&&(T.spots[t].actions.click="no-action"),"[object Array]"!==Object.prototype.toString.call(T.spots[t].points)&&(T.spots[t].points=[]),"[object Array]"!==Object.prototype.toString.call(T.spots[t].vs)&&(T.spots[t].vs=[])}for(t=0;t<T.spots.length;t++){if((r=T.spots[t]).tooltip_content&&r.tooltip_content.title&&(r.title=r.tooltip_content.title,r.tooltip_content.title=y),r.tooltip_style&&r.tooltip_style.enable_tooltip&&(r.tooltip.enable_tooltip=r.tooltip_style.enable_tooltip,r.tooltip_style.enable_tooltip=y),r.tooltip_content.plain_text&&"content-builder"!=r.tooltip_content.content_type){var o={containers:[{id:"sq-container-160121",settings:{elements:[{settings:{name:"Paragraph",iconClass:"fa fa-paragraph"},options:{text:{text:r.tooltip_content.plain_text},font:{text_color:r.tooltip_content.plain_text_color}}}]}}]};r.tooltip_content.squares_settings=o,r.tooltip_content.content_type=y,r.tooltip_content.plain_text=y,r.tooltip_content.plain_text_color=y}r.default_style&&r.default_style.fill&&(r.default_style.background_color=r.default_style.fill,delete r.default_style.fill),r.default_style&&r.default_style.fill_opacity&&(r.default_style.background_opacity=r.default_style.fill_opacity,delete r.default_style.fill_opacity),r.mouseover_style&&r.mouseover_style.fill&&(r.mouseover_style.background_color=r.mouseover_style.fill,delete r.mouseover_style.fill),r.mouseover_style&&r.mouseover_style.fill_opacity&&(r.mouseover_style.background_opacity=r.mouseover_style.fill_opacity,delete r.mouseover_style.fill_opacity)}T.shapes||(T.shapes=H.imageMapProDefaultSettings.shapes,T.general&&T.general.pageload_animation&&(T.shapes.pageload_animation=T.general.pageload_animation,T.general.pageload_animation=y));var i=[];for(t=0;t<T.spots.length;t++){var r;if((r=T.spots[t]).x=parseFloat(r.x),r.y=parseFloat(r.y),r.width&&(r.width=parseFloat(r.width)),r.height&&(r.height=parseFloat(r.height)),"poly"==r.type){if(r.points.length<3)continue;if(r.points)for(var s=0;s<r.points.length;s++)r.points[s].x=parseFloat(r.points[s].x),r.points[s].y=parseFloat(r.points[s].y);if(r.vs)for(s=0;s<r.vs.length;s++)for(var a=0;a<r.vs[s].length;a++)r.vs[s][0]=parseFloat(r.vs[s][0]),r.vs[s][1]=parseFloat(r.vs[s][1])}i.push(r)}T.spots=i,T.general=H.extend(!0,{},S.general,T.general),T.image=H.extend(!0,{},S.image,T.image),T.shapes=H.extend(!0,{},S.shapes,T.shapes),T.tooltips=H.extend(!0,{},S.tooltips,T.tooltips),T.fullscreen=H.extend(!0,{},S.fullscreen,T.fullscreen),T.zooming=H.extend(!0,{},S.zooming,T.zooming),T.editor=H.extend(!0,{},S.editor,T.editor),T.custom_code=H.extend(!0,{},S.custom_code,T.custom_code),T.layers=H.extend(!0,{},S.layers,T.layers),T.shapes_menu=H.extend(!0,{},S.shapes_menu,T.shapes_menu),T.general.width=parseInt(T.general.width),T.general.height=parseInt(T.general.height),T.general.image_url&&(T.image.url=T.general.image_url,T.general.image_url=y),T.general.sticky_tooltips&&(T.tooltips.sticky_tooltips=T.general.sticky_tooltips,T.general.sticky_tooltips=y),T.general.constrain_tooltips&&(T.tooltips.constrain_tooltips=T.general.constrain_tooltips,T.general.constrain_tooltips=y),T.general.fullscreen_tooltips&&(T.tooltips.fullscreen_tooltips=T.general.fullscreen_tooltips,T.general.fullscreen_tooltips=y),T.general.tooltip_animation&&(T.tooltips.tooltip_animation=T.general.tooltip_animation,T.general.tooltip_animation=y);for(t=0;t<T.spots.length;t++)T.spots[t].tooltip_content.squares_settings||(T.spots[t].tooltip_content.squares_settings=H.extend(!0,{},f.tooltip_content.squares_settings));T.general.imageurl&&(T.image.url=T.general.imageurl),T.general.name=T.general.name.trim(),T.general.shortcode=T.general.shortcode.trim()},l.prototype.redraw=function(){if(z(T.editor.previewMode)){e=this.getCanvasDefaultSize();""!=T.image.url?H("#wcp-editor-canvas").css({width:"auto",height:"auto","max-width":e.w,"max-height":e.h}):H("#wcp-editor-canvas").css({width:"100%",height:"auto","max-width":e.w,"max-height":e.h});var t=H.extend(!0,{},T);t.fullscreen.start_in_fullscreen_mode=0,t.shapes_menu.detached_menu=0,H("#wcp-editor-canvas").imageMapPro(t),1!=this.zoom&&this.zoomReset(),H.wcpEditorSetPreviewModeOn()}else{var e=this.getCanvasDefaultSize();this.canvasWidth=e.w*this.zoom,this.canvasHeight=e.h*this.zoom,H("#wcp-editor-canvas").css({width:this.canvasWidth,height:this.canvasHeight,"max-width":"none","max-height":"none"}),H("#wcp-editor-canvas").html(H.image_map_pro_editor_content()),H("#imp-editor-image").css({width:this.canvasWidth,height:this.canvasHeight}),H.wcpEditorSetPreviewModeOff()}this.redrawSpotSelection(),this.redrawSelectedSpotTooltip(),this.updateShapesForm(),this.updateShapesFormState(),this.updateShapesList(),this.updateImageMapFormState(),this.drawingPoly&&this.redrawTempPoly()},l.prototype.redrawCanvas=function(){this.canvas.css({transform:"translate("+this.canvasX+"px, "+this.canvasY+"px)"})},l.prototype.getCanvasDefaultSize=function(){var t={w:0,h:0},e=H("#wcp-editor-center").width()-80,o=H("#wcp-editor-center").height()-80,i=0,r=0;if(z(T.layers.enable_layers)){for(var s=0;s<T.layers.layers_list.length;s++)if(parseInt(T.layers.layers_list[s].id,10)==parseInt(T.editor.currentLayer,10)){i=T.layers.layers_list[s].image_width,r=T.layers.layers_list[s].image_height;break}}else i=T.general.width,r=T.general.height;if(e<i||o<r){var a=i/r;a<=e/o?(t.w=o*a,t.h=H("#wcp-editor-center").height()-80):(t.w=H("#wcp-editor-center").width()-80,t.h=e/a)}else t.w=i,t.h=r;return t},l.prototype.redrawSpotSelection=function(){var t=this;if(H(".imp-editor-shape").removeClass("selected"),H("#imp-editor-shape-tooltip").removeClass("selected"),-1!=T.editor.selected_shape){var e=t.getIndexOfSpotWithId(T.editor.selected_shape);if(e==y)return void(T.editor.selected_shape=-1);if(this.tooltipTransformMode)return H("#imp-editor-shape-tooltip").addClass("selected"),void H("#wcp-editor-tooltip").remove();H('.imp-editor-shape[data-id="'+T.editor.selected_shape+'"]').addClass("selected"),t.selectedSpot=T.spots[e],"poly"==t.selectedSpot.type&&(t.tempControlPoint=H('.imp-editor-poly[data-id="'+T.editor.selected_shape+'"]').find(".imp-editor-poly-svg-temp-control-point"),t.tempControlPointLine=H('.imp-editor-poly[data-id="'+T.editor.selected_shape+'"]').find(".imp-editor-poly-svg-temp-control-point-line"))}else t.selectedSpot=y},l.prototype.redrawSelectedSpotTooltip=function(){if(this.selectedSpot&&"text"!=this.selectedSpot.type){var t=H("#imp-editor-shape-tooltip");if(0==t.length)return;var e=0,o=0,i=this.selectedSpot,r=t[0].getBoundingClientRect().width/this.canvasWidth*100,s=t[0].getBoundingClientRect().height/this.canvasHeight*100,a=20/this.canvasWidth*100,n=20/this.canvasHeight*100,l=i.width,p=i.height,d=i.x,c=i.y;"spot"==i.type&&(l=i.width/this.canvasWidth*100,p=i.height/this.canvasHeight*100,d=i.x-l/2,c=i.y-p/2,z(i.default_style.icon_is_pin)&&z(i.default_style.use_icon)&&(c-=p/2)),"top"==i.tooltip_style.position&&(e=d+l/2-r/2,o=c-s-n),"bottom"==i.tooltip_style.position&&(e=d+l/2-r/2,o=c+p+n),"left"==i.tooltip_style.position&&(e=d-r-a,o=c+p/2-s/2),"right"==i.tooltip_style.position&&(e=d+l+a,o=c+p/2-s/2),e+=i.tooltip_style.offset_x,o+=i.tooltip_style.offset_y,t.css({left:e+"%",top:o+"%",width:r+"%"})}},l.prototype.events=function(){var l=this;H(o).off("squares_image_loaded"),H(o).on("squares_image_loaded",function(){l.redrawSelectedSpotTooltip()}),H(o).off("button-choose-icon-clicked"),H(o).on("button-choose-icon-clicked",function(){H.wcpEditorPresentModal({name:"modal-choose-icon",title:"Choose Icon",buttons:[{name:"cancel",title:"Cancel",class:"default",id:"imp-editor-button-cancel-choose-icon"}],body:l.iconsHTML})}),H(o).off("button-copy-from-default-styles-clicked"),H(o).on("button-copy-from-default-styles-clicked",function(){l.selectedSpot.mouseover_style.opacity=l.selectedSpot.default_style.opacity,l.selectedSpot.mouseover_style.background_image_url=l.selectedSpot.default_style.background_image_url,l.selectedSpot.mouseover_style.background_image_opacity=l.selectedSpot.default_style.background_image_opacity,l.selectedSpot.mouseover_style.background_image_scale=l.selectedSpot.default_style.background_image_scale,l.selectedSpot.mouseover_style.background_image_offset_x=l.selectedSpot.default_style.background_image_offset_x,l.selectedSpot.mouseover_style.background_image_offset_y=l.selectedSpot.default_style.background_image_offset_y,l.selectedSpot.mouseover_style.background_color=l.selectedSpot.default_style.background_color,l.selectedSpot.mouseover_style.background_opacity=l.selectedSpot.default_style.background_opacity,l.selectedSpot.mouseover_style.icon_fill=l.selectedSpot.default_style.icon_fill,l.selectedSpot.mouseover_style.border_radius=l.selectedSpot.default_style.border_radius,l.selectedSpot.mouseover_style.border_width=l.selectedSpot.default_style.border_width,l.selectedSpot.mouseover_style.border_style=l.selectedSpot.default_style.border_style,l.selectedSpot.mouseover_style.border_color=l.selectedSpot.default_style.border_color,l.selectedSpot.mouseover_style.border_opacity=l.selectedSpot.default_style.border_opacity,l.selectedSpot.mouseover_style.stroke_color=l.selectedSpot.default_style.stroke_color,l.selectedSpot.mouseover_style.stroke_opacity=l.selectedSpot.default_style.stroke_opacity,l.selectedSpot.mouseover_style.stroke_width=l.selectedSpot.default_style.stroke_width,l.selectedSpot.mouseover_style.stroke_dasharray=l.selectedSpot.default_style.stroke_dasharray,l.selectedSpot.mouseover_style.stroke_linecap=l.selectedSpot.default_style.stroke_linecap,l.redraw(),l.addAction()}),H(o).off("button-reset-size-clicked"),H(o).on("button-reset-size-clicked",function(){""!=T.image.url?(T.general.width=l.canvasImage.naturalWidth,T.general.height=l.canvasImage.naturalHeight):(T.general.width=S.general.naturalWidth,T.general.height=S.general.naturalHeight,T.general.naturalWidth=S.general.naturalWidth,T.general.naturalHeight=S.general.naturalHeight),l.updateImageMapForm(),l.redraw()}),H(o).off("button-launch-content-builder-clicked"),H(o).on("button-launch-content-builder-clicked",function(){l.launchTooltipContentBuilder()}),H(o).off("click",".fontawesome-icon-wrap"),H(o).on("click",".fontawesome-icon-wrap",function(){H.wcpEditorCloseModal(),l.selectedSpot.default_style.icon_fontawesome_id=H(this).data("fontawesome-id"),l.redraw(),l.addAction()}),H(o).off("click",".category-title-wrap"),H(o).on("click",".category-title-wrap",function(){H(this).toggleClass("active"),H(this).next().toggle()}),H(o).off("click","#imp-editor-done-editing-tooltip, #imp-editor-tooltip-content-builder-close"),H(o).on("click","#imp-editor-done-editing-tooltip, #imp-editor-tooltip-content-builder-close",function(){H("#imp-editor-tooltip-content-builder-wrap").removeClass("imp-visible"),setTimeout(function(){H("#imp-editor-tooltip-content-builder-wrap").hide()},250),l.doneEditingTooltip(),H.squaresHideEditorWindow()}),H(o).on("mouseout","#wcp-editor-right",function(t){if(z(T.editor.previewMode))for(var e=0;e<T.spots.length;e++)H.imageMapProUnhighlightShape(T.general.name,T.spots[e].title)}),H(o).off("click","#wcp-editor-control-import-type .wcp-editor-control-button-group-button"),H(o).on("click","#wcp-editor-control-import-type .wcp-editor-control-button-group-button",function(){H(this).addClass("active").siblings().removeClass("active"),H("#wcp-editor-control-import-type").data("value",H(this).data("button-value")),"svg-xml-code"==H("#wcp-editor-control-import-type").data("value")?H("#wcp-editor-import-info").show():H("#wcp-editor-import-info").hide()}),H(o).off("event-layers-list-add"),H(o).on("event-layers-list-add",function(){H.wcpEditorPresentModal({name:"modal-add-layer",title:"Add Layer",buttons:[{name:"cancel",title:"Cancel",class:"default",id:"imp-editor-button-cancel-add-layer"},{name:"primary",title:"Create",class:"primary",id:"imp-editor-button-create-layer"}],body:H.wcpFormGenerateHTMLForForm("New/Edit Layer")}),H.wcpFormSetControlValue("New/Edit Layer","name","Untitled"),H.wcpFormSetControlValue("New/Edit Layer","url",""),H.wcpFormUpdateForm("New/Edit Layer")}),H(o).off("event-layers-list-remove"),H(o).on("event-layers-list-remove",function(t,e){u=e;H.wcpEditorPresentModal({name:"modal-confirm-delete-floor",title:"Delete Floor",buttons:[{name:"cancel",title:"Cancel",class:"default",id:"imp-editor-button-cancel-delete-floor"},{name:"primary",title:"Delete",class:"danger",id:"imp-editor-button-delete-floor"}],body:"Are you sure you want to permanently delete this floor and all shapes in it?"})}),H(o).off("event-layers-list-duplicate"),H(o).on("event-layers-list-duplicate",function(t,e){for(var o=0;o<T.layers.layers_list.length;o++){var i=l.createIdForLayer();if(T.layers.layers_list[o].id==e){var r={id:i,image_height:T.layers.layers_list[o].image_height,image_width:T.layers.layers_list[o].image_width,image_url:T.layers.layers_list[o].image_url,title:T.layers.layers_list[o].title+" Copy"};T.layers.layers_list.splice(o+1,0,r);break}}var s=T.spots.length;for(o=0;o<s;o++){var a=T.spots[o];if(a.layerID==e){var n=H.extend(!0,{},a);n.layerID=i,"spot"==n.type&&(n.id=l.createIdForSpot()),"rect"==n.type&&(n.id=l.createIdForRect()),"oval"==n.type&&(n.id=l.createIdForOval()),"poly"==n.type&&(n.id=l.createIdForPoly()),"text"==n.type&&(n.id=l.createIdForText()),T.spots.push(n)}}l.updateImageMapForm(),l.redraw()}),H(o).off("event-layers-list-up"),H(o).on("event-layers-list-up",function(){}),H(o).off("event-layers-list-down"),H(o).on("event-layers-list-down",function(){}),H(o).off("event-layers-list-edit"),H(o).on("event-layers-list-edit",function(t,e){w=e,H.wcpEditorPresentModal({name:"modal-edit-layer",title:"Edit Layer",buttons:[{name:"cancel",title:"Cancel",class:"default",id:"imp-editor-button-cancel-add-layer"},{name:"primary",title:"Done",class:"primary",id:"imp-editor-button-edit-layer-done"}],body:H.wcpFormGenerateHTMLForForm("New/Edit Layer")});var o=H('[data-wcp-form-layers-list-control-option-id="'+e+'"]');H.wcpFormSetControlValue("New/Edit Layer","name",o.data("wcp-form-layers-list-control-option-title")),H.wcpFormSetControlValue("New/Edit Layer","url",o.data("wcp-form-layers-list-control-option-image-url")),H.wcpFormUpdateForm("New/Edit Layer")}),H(o).off("change","#select-canvas-layer"),H(o).on("change","#select-canvas-layer",function(){T.editor.currentLayer=H("#select-canvas-layer").val(),l.updateShapesList(),l.deselectSpot(),l.redraw()}),H(o).off("button-reset-tooltip-position-clicked"),H(o).on("button-reset-tooltip-position-clicked",function(){l.selectedSpot&&(l.selectedSpot.tooltip_style.offset_x=H.imageMapProDefaultSpotSettings.tooltip_style.offset_x,l.selectedSpot.tooltip_style.offset_y=H.imageMapProDefaultSpotSettings.tooltip_style.offset_y,l.selectedSpot.tooltip_style.position=H.imageMapProDefaultSpotSettings.tooltip_style.position),l.addAction(),l.redraw()}),H(o).off("button-reset-tooltip-size-clicked"),H(o).on("button-reset-tooltip-size-clicked",function(){l.selectedSpot&&(l.selectedSpot.tooltip_style.width=H.imageMapProDefaultSpotSettings.tooltip_style.width),l.addAction(),l.redraw()}),H(o).off("button-edit-tooltip-style-clicked"),H(o).on("button-edit-tooltip-style-clicked",function(){if(1==T.editor.transform_tooltip_mode&&(T.editor.transform_tooltip_mode=0,l.tooltipTransformMode=!1,l.redraw()),H.wcpEditorIsFloatingWindowOpen())return H.wcpEditorCloseFloatingWindow(),void l.redraw();var t=H('[data-editor-object-type="10"]').parent(),e=t.offset().left,o=t.offset().top,i=t.width(),r=H.wcpFormGenerateHTMLForForm("Tooltip Style"),s={x:Math.round(e+i+10),y:Math.round(o),padding:!0,title:"Tooltip Style",width:300,content:r};H.wcpEditorCreateFloatingWindow(s),l.updateShapesForm(),l.redraw()}),H(o).off("button-edit-tooltip-position-clicked"),H(o).on("button-edit-tooltip-position-clicked",function(){H.wcpEditorIsFloatingWindowOpen()&&H.wcpEditorCloseFloatingWindow(),1==T.editor.transform_tooltip_mode?(T.editor.transform_tooltip_mode=0,l.tooltipTransformMode=!1):(T.editor.transform_tooltip_mode=1,l.tooltipTransformMode=!0,l.transformingTooltipStartingWidth=H("#imp-editor-shape-tooltip").outerWidth()),l.redraw()}),H(o).off("button-edit-tooltip-content-clicked"),H(o).on("button-edit-tooltip-content-clicked",function(){if(1==T.editor.transform_tooltip_mode&&(T.editor.transform_tooltip_mode=0,l.tooltipTransformMode=!1,l.redraw()),H.wcpEditorIsFloatingWindowOpen())return H.wcpEditorCloseFloatingWindow(),void l.redraw();var t=H('[data-editor-object-type="10"]').parent(),e=t.offset().left,o=t.offset().top,i=t.width();H.squaresInitWithSettings(H("#imp-editor-shape-tooltip-content-wrap"),l.selectedSpot.tooltip_content.squares_settings);var r=H.squaresGetEditorWindowContents(),s={x:Math.round(e+i+10),y:Math.round(o),padding:!1,title:"Tooltip Content",content:r,width:394};H.wcpEditorCreateFloatingWindow(s)})},l.prototype.canvas_events=function(){var e=this;H(t).off("resize.imp-redraw"),H(t).on("resize.imp-redraw",function(){e.redraw()}),H(o).off("mousedown","#wcp-editor-center"),H(o).on("mousedown","#wcp-editor-center",function(t){e.handleMouseDown(t)}),H(o).off("mousemove","#wcp-editor"),H(o).on("mousemove","#wcp-editor",function(t){e.handleMouseMove(t)}),H(o).off("mouseup","#wcp-editor"),H(o).on("mouseup","#wcp-editor",function(t){e.handleMouseUp(t)}),H("body").on("contextmenu",function(t){if(e.didDeleteControlPoint)return e.didDeleteControlPoint=!1}),H(o).off("keydown.canvasEvents"),H(o).on("keydown.canvasEvents",function(t){return e.handleKeyDown(t)}),H(o).off("keyup.canvasEvents"),H(o).on("keyup.canvasEvents",function(t){return e.handleKeyUp(t)})},l.prototype.addAction=function(){var t=this;t.actionIndex<t.actionStack.length-1&&t.actionStack.splice(t.actionIndex+1,t.actionStack.length),t.actionStack.push(H.extend(!0,{},T)),t.actionIndex++,100<t.actionStack.length&&(t.actionStack.splice(0,1),t.actionIndex--),H("#button-save").html('<span class="glyphicon glyphicon-hdd"></span> Save')},l.prototype.undo=function(){var t=this;0<t.actionIndex&&t.actionIndex--,T=H.extend(!0,{},t.actionStack[t.actionIndex]),t.redraw(),t.updateImageMapForm(),t.updateImageMapFormState(),t.updateShapesForm(),t.updateShapesFormState()},l.prototype.redo=function(){var t=this;t.actionIndex<t.actionStack.length-1&&t.actionIndex++,T=H.extend(!0,{},t.actionStack[t.actionIndex]),t.redraw(),t.updateImageMapForm(),t.updateImageMapFormState(),t.updateShapesForm(),t.updateShapesFormState()},l.prototype.handleMouseDown=function(t){var e=this;if("wcp-editor-toolbar"!=H(t.target).attr("id")&&1!=H(t.target).closest("#wcp-editor-toolbar").length&&"wcp-editor-extra-main-buttons"!=H(t.target).attr("id")&&1!=H(t.target).closest("#wcp-editor-extra-main-buttons").length&&!(0<H(t.target).closest("#wcp-editor-floating-window").length||"wcp-editor-floating-window"==H(t.target).attr("id")||"imp-poly-tooltip-close-button"==H(t.target).attr("id")||z(T.editor.previewMode)||H("body").hasClass("modal-open"))){var o=P(t.pageX,t.pageY,e.canvas);e.ix=o.x,e.iy=o.y,e.ixss=t.pageX,e.iyss=t.pageY;var i=!1;0<o.x&&o.x<e.canvasWidth*e.zoom&&0<o.y&&o.y<e.canvasHeight*e.zoom&&(i=!0);var r=H(t.target).data("editor-object-type")||H(t.target).closest("[data-editor-object-type]").data("editor-object-type");if((e.spaceKeyDown||T.editor.tool==a)&&i)return e.draggingCanvas=!0,e.canvasInitialX=e.canvasX,void(e.canvasInitialY=e.canvasY);if("zoom-in"==T.editor.tool&&"wcp-editor-center"!=H(t.target).attr("id"))return e.zoomIn(t),void(this.shouldDeselectShape=!0);if("zoom-out"==T.editor.tool&&"wcp-editor-center"!=H(t.target).attr("id"))return e.zoomOut(t),void(this.shouldDeselectShape=!0);if(e.drawingPoly)return H(t.target).is("circle")&&0==H(t.target).data("index")?(e.drawingPoly=!1,void(e.finishedDrawingPoly=!0)):(e.placePointForTempPoly(e.ix,e.iy),e.redrawTempPoly(),void(e.mouseDownWhileDrawingPoly=!0));if(T.editor.tool==a&&"wcp-editor-center"!=H(t.target).attr("id"))return e.startedDraggingCanvas=!0,void(this.shouldDeselectShape=!0);if(7==r)return H(t.target).addClass("active"),e.translatedPointIndex=H(t.target).data("index"),2==t.button?(e.selectedSpot.points.splice(e.translatedPointIndex,1),e.updateBoundingBoxForPolygonSpot(e.selectedSpot),e.redraw(),e.addAction(),void(e.didDeleteControlPoint=!0)):(e.translatingControlPoint=!0,e.translatedPointX=e.selectedSpot.points[e.translatedPointIndex].x,e.translatedPointY=e.selectedSpot.points[e.translatedPointIndex].y,e.translatedPoint=H(t.target),void(e.redrawPolygonEl=H(t.target).closest(".imp-editor-shape").find(".imp-editor-poly-svg polygon")));if(6==r)return e.selectedSpot.points.splice(e.tempControlPointIndex+1,0,{x:e.controlPointInsertionPointX,y:e.controlPointInsertionPointY}),e.redraw(),(o=H('.imp-editor-shape[data-id="'+e.selectedSpot.id+'"]').find('.imp-poly-control-point[data-index="'+(e.tempControlPointIndex+1)+'"]')).addClass("active"),e.translatedPointIndex=o.data("index"),e.translatingControlPoint=!0,e.translatedPointX=e.selectedSpot.points[e.translatedPointIndex].x,e.translatedPointY=e.selectedSpot.points[e.translatedPointIndex].y,e.translatedPoint=o,void(e.redrawPolygonEl=o.closest(".imp-editor-shape").find(".imp-editor-poly-svg polygon"));if(5!=r)if(9!=r){if(15==r&&(this.transformDirection=H(t.target).data("transform-direction"),this.startedTransformingTooltip=!0,this.didTransformTooltip=!1,this.redrawTooltip=H("#imp-editor-shape-tooltip")),10!=r&&11!=r&&12!=r&&13!=r&&14!=r&&!this.tooltipTransformMode){for(s=T.spots.length-1;0<=s;s--)if("poly"==T.spots[s].type&&(!z(T.layers.enable_layers)||T.spots[s].layerID==T.editor.currentLayer)&&e.shouldSelectPoly(T.spots[s].id))return e.eventSpotId=T.spots[s].id,void(e.startedSelecting=!0);if((H(t.target).hasClass("imp-editor-shape")||0<H(t.target).closest(".imp-editor-shape").length)&&!H(t.target).hasClass("imp-editor-poly")&&0==H(t.target).closest(".imp-editor-poly").length)return e.eventSpotId=H(t.target).data("id")||H(t.target).closest(".imp-editor-shape").data("id"),void(e.startedSelecting=!0);if(i){if("spot"==T.editor.tool)return void(e.startedDrawingSpot=!0);if("rect"==T.editor.tool)return void(e.startedDrawingRect=!0);if("oval"==T.editor.tool)return void(e.startedDrawingOval=!0);if("poly"==T.editor.tool)return e.startedDrawingPoly=!0,e.deselectSpot(),e.redraw(),e.polyPoints=new Array,H("#imp-editor-shapes-container").append('<svg id="temp-poly" width="'+e.canvasWidth+'px" height="'+e.canvasHeight+'px" viewBox="0 0 '+e.canvasWidth+" "+e.canvasHeight+'" version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>'),e.placePointForTempPoly(e.ix,e.iy),e.redrawTempPoly(),e.mouseDownWhileDrawingPoly=!0,void(e.drawingPoly=!0);if("text"==T.editor.tool)return void(e.startedDrawingText=!0)}("select"==T.editor.tool&&0==r||"wcp-editor-center"==H(t.target).attr("id")&&this.selectedSpot)&&(this.shouldDeselectShape=!0)}}else this.tooltipTransformMode&&(this.startedSelectingTooltip=!0);else if(e.startedTransforming=!0,e.transformDirection=H(t.target).data("transform-direction"),e.redrawEl=H(t.target).closest(".imp-editor-shape"),e.redrawElBgImage=H('.imp-editor-shape-background-image[data-id="'+e.selectedSpot.id+'"]'),"poly"==e.selectedSpot.type){e.redrawSvgEl=e.redrawEl.find(".imp-editor-poly-svg"),e.redrawPolygonEl=e.redrawSvgEl.find("polygon"),e.polyPoints=new Array;for(var s=0;s<e.selectedSpot.points.length;s++)e.polyPoints.push({x:e.selectedSpot.points[s].x,y:e.selectedSpot.points[s].y})}}},l.prototype.handleMouseMove=function(t){if(!z(T.editor.previewMode)){var e=P(t.pageX,t.pageY,this.canvas);if(this.x=e.x,this.y=e.y,this.dx=(this.x-this.ix)/this.canvasWidth*100,this.dy=(this.y-this.iy)/this.canvasHeight*100,this.dx=Math.round(1e3*this.dx)/1e3,this.dy=Math.round(1e3*this.dy)/1e3,this.xss=t.pageX,this.yss=t.pageY,this.dxss=this.xss-this.ixss,this.dyss=this.yss-this.iyss,this.startedSelectingTooltip){this.movingTooltip=!0,this.startedSelectingTooltip=!1,this.redrawTooltip=H("#imp-editor-shape-tooltip"),this.movingTooltipPosition=this.selectedSpot.tooltip_style.position;var o=E(this.selectedSpot.default_style.background_color);this.movingTooltipColorRGBA="rgba("+o.r+", "+o.g+", "+o.b+", "+this.selectedSpot.tooltip_style.background_opacity+")",this.movingTooltipArrow=this.redrawTooltip.find(".hs-arrow"),"spot"!=this.selectedSpot.type?(this.movingTooltipShapeCenterX=this.selectedSpot.x+this.selectedSpot.width/2,this.movingTooltipShapeCenterY=this.selectedSpot.y+this.selectedSpot.height/2,this.movingTooltipShapeCenterX=this.movingTooltipShapeCenterX/100*this.canvasWidth,this.movingTooltipShapeCenterY=this.movingTooltipShapeCenterY/100*this.canvasHeight):(this.movingTooltipShapeCenterX=this.selectedSpot.x/100*this.canvasWidth+this.selectedSpot.width/2,this.movingTooltipShapeCenterY=this.selectedSpot.y/100*this.canvasHeight+this.selectedSpot.height/2),this.movingTooltipCenterX=this.redrawTooltip.position().left+this.redrawTooltip.outerWidth()/2,this.movingTooltipCenterY=this.redrawTooltip.position().top+this.redrawTooltip.outerHeight()/2}if(this.movingTooltip&&this.redrawTooltip){this.redrawTooltip.css({transform:"translate("+(this.x-this.ix)+"px,"+(this.y-this.iy)+"px)"});var i=this.movingTooltipCenterX+(this.x-this.ix)-this.movingTooltipShapeCenterX,r=this.movingTooltipCenterY+(this.y-this.iy)-this.movingTooltipShapeCenterY,s=180*Math.atan2(r,i)/Math.PI;-135<s&&s<-45&&(this.movingTooltipPosition="top",this.movingTooltipArrow.attr("class","hs-arrow hs-arrow-bottom"),this.movingTooltipArrow.css("border-top-color",this.movingTooltipColorRGBA),this.movingTooltipArrow.css("border-bottom-color",""),this.movingTooltipArrow.css("border-left-color",""),this.movingTooltipArrow.css("border-right-color","")),(135<s&&s<180||-180<s&&s<-135)&&(this.movingTooltipPosition="left",this.movingTooltipArrow.attr("class","hs-arrow hs-arrow-right"),this.movingTooltipArrow.css("border-top-color",""),this.movingTooltipArrow.css("border-bottom-color",""),this.movingTooltipArrow.css("border-left-color",this.movingTooltipColorRGBA),this.movingTooltipArrow.css("border-right-color","")),-45<s&&s<45&&(this.movingTooltipPosition="right",this.movingTooltipArrow.attr("class","hs-arrow hs-arrow-left"),this.movingTooltipArrow.css("border-top-color",""),this.movingTooltipArrow.css("border-bottom-color",""),this.movingTooltipArrow.css("border-left-color",""),this.movingTooltipArrow.css("border-right-color",this.movingTooltipColorRGBA)),45<s&&s<135&&(this.movingTooltipPosition="bottom",this.movingTooltipArrow.attr("class","hs-arrow hs-arrow-top"),this.movingTooltipArrow.css("border-top-color",""),this.movingTooltipArrow.css("border-bottom-color",this.movingTooltipColorRGBA),this.movingTooltipArrow.css("border-left-color",""),this.movingTooltipArrow.css("border-right-color",""))}if(this.draggingCanvas){var a=this.canvasInitialX+this.dxss,n=this.canvasInitialY+this.dyss;this.canvasX=this.canvasInitialX+this.dxss,this.canvasY=this.canvasInitialY+this.dyss,this.redrawCanvas()}if(this.startedSelecting&&(this.redrawTooltip=H("#imp-editor-shape-tooltip"),this.selectedSpot&&this.eventSpotId!=this.selectedSpot.id&&this.redrawTooltip.remove(),this.selectSpot(this.eventSpotId),this.redrawEl=H('.imp-editor-shape[data-id="'+this.eventSpotId+'"]'),this.redrawElBgImage=H('.imp-editor-shape-background-image[data-id="'+this.eventSpotId+'"]'),this.redrawSpotSelection(),this.startedMoving=!0,this.startedSelecting=!1),this.startedMoving){var l=D(this.selectedSpot.x+this.dx,this.selectedSpot.y+this.dy);"rect"!=this.selectedSpot.type&&"oval"!=this.selectedSpot.type&&"poly"!=this.selectedSpot.type||(100<l.x+this.selectedSpot.width&&(l.x=100-this.selectedSpot.width),100<l.y+this.selectedSpot.height&&(l.y=100-this.selectedSpot.height)),this.redrawEl.css({left:l.x+"%",top:l.y+"%"}),this.redrawElBgImage&&this.redrawElBgImage.css({left:l.x+"%",top:l.y+"%"});var p=(l.x-this.selectedSpot.x)/100*this.canvasWidth,d=(l.y-this.selectedSpot.y)/100*this.canvasHeight;this.redrawTooltip&&this.redrawTooltip.css({transform:"translate("+p+"px,"+d+"px)"})}else if(this.startedTransforming){if(this.didTransform=!0,this.shiftKeyDown){var c=this.selectedSpot.width/this.selectedSpot.height;1!=this.transformDirection&&5!=this.transformDirection||(this.dy=this.dx/c),3!=this.transformDirection&&7!=this.transformDirection||(this.dy=-this.dx/c)}if(1==this.transformDirection&&(l={x:this.selectedSpot.x+this.dx,y:this.selectedSpot.y+this.dy},w={x:this.selectedSpot.width-this.dx,y:this.selectedSpot.height-this.dy}),2==this.transformDirection&&(l={x:this.selectedSpot.x,y:this.selectedSpot.y+this.dy},w={x:this.selectedSpot.width,y:this.selectedSpot.height-this.dy}),3==this.transformDirection&&(l={x:this.selectedSpot.x,y:this.selectedSpot.y+this.dy},w={x:this.selectedSpot.width+this.dx,y:this.selectedSpot.height-this.dy}),4==this.transformDirection&&(l={x:this.selectedSpot.x,y:this.selectedSpot.y},w={x:this.selectedSpot.width+this.dx,y:this.selectedSpot.height}),5==this.transformDirection&&(l={x:this.selectedSpot.x,y:this.selectedSpot.y},w={x:this.selectedSpot.width+this.dx,y:this.selectedSpot.height+this.dy}),6==this.transformDirection&&(l={x:this.selectedSpot.x,y:this.selectedSpot.y},w={x:this.selectedSpot.width,y:this.selectedSpot.height+this.dy}),7==this.transformDirection&&(l={x:this.selectedSpot.x+this.dx,y:this.selectedSpot.y},w={x:this.selectedSpot.width-this.dx,y:this.selectedSpot.height+this.dy}),8==this.transformDirection&&(l={x:this.selectedSpot.x+this.dx,y:this.selectedSpot.y},w={x:this.selectedSpot.width-this.dx,y:this.selectedSpot.height}),l.x<0&&(w.x=this.selectedSpot.x+this.selectedSpot.width,l.x=0),l.y<0&&(l.y=0,w.y=this.selectedSpot.y+this.selectedSpot.height),100<w.x+l.x&&(w.x=100-l.x),100<w.y+l.y&&(w.y=100-l.y),l.x>this.selectedSpot.x+this.selectedSpot.width&&(l.x=this.selectedSpot.x+this.selectedSpot.width),l.y>this.selectedSpot.y+this.selectedSpot.height&&(l.y=this.selectedSpot.y+this.selectedSpot.height),w.x<0&&(w.x=0),w.y<0&&(w.y=0),this.transformX=l.x,this.transformY=l.y,this.transformWidth=w.x,this.transformHeight=w.y,this.redrawEl.css({left:this.transformX+"%",top:this.transformY+"%",width:this.transformWidth+"%",height:this.transformHeight+"%"}),this.redrawElBgImage.css({left:this.transformX+"%",top:this.transformY+"%",width:this.transformWidth+"%",height:this.transformHeight+"%"}),"poly"==this.selectedSpot.type){var h=T.general.width*(w.x/100),g=T.general.height*(w.y/100);this.redrawSvgEl[0].setAttribute("viewBox","0 0 "+h+" "+g);for(var m="",_=0;_<this.selectedSpot.points.length;_++){var u=this.selectedSpot.points[_];m+=(a=this.selectedSpot.default_style.stroke_width+u.x/100*(h-2*this.selectedSpot.default_style.stroke_width))+","+(n=this.selectedSpot.default_style.stroke_width+u.y/100*(g-2*this.selectedSpot.default_style.stroke_width))+" "}this.redrawPolygonEl.attr("points",m)}}else{if(this.startedTransformingTooltip){this.didTransformTooltip=!0;var w=this.ix-this.x;"top"==this.selectedSpot.tooltip_style.position||"bottom"==this.selectedSpot.tooltip_style.position?(4==this.transformDirection&&(this.transformingTooltipWidth=this.transformingTooltipStartingWidth-2*w),8==this.transformDirection&&(this.transformingTooltipWidth=this.transformingTooltipStartingWidth+2*w)):(4==this.transformDirection&&(this.transformingTooltipWidth=this.transformingTooltipStartingWidth-w),8==this.transformDirection&&(this.transformingTooltipWidth=this.transformingTooltipStartingWidth+w));var y=this.redrawTooltip,S=(a=0,n=0,this.selectedSpot),f=this.transformingTooltipWidth/this.canvasWidth*100,v=y.outerHeight()/this.canvasHeight*100,b=20/this.canvasWidth*100,x=20/this.canvasHeight*100,C=S.width,F=S.height,k=S.x,M=S.y;"spot"==S.type&&(C=S.width/this.canvasWidth*100,F=S.height/this.canvasHeight*100,k=S.x-C/2,M=S.y-F/2,z(S.default_style.icon_is_pin)&&(M-=F/2)),"top"==S.tooltip_style.position&&(a=k+C/2-f/2,n=M-v-x),"bottom"==S.tooltip_style.position&&(a=k+C/2-f/2,n=M+F+x),"left"==S.tooltip_style.position&&(a=k-f-b,n=M+F/2-v/2),"right"==S.tooltip_style.position&&(a=k+C+b,n=M+F/2-v/2),a+=S.tooltip_style.offset_x,n+=S.tooltip_style.offset_y,this.redrawTooltip.css({width:this.transformingTooltipWidth,left:a+"%",top:n+"%"})}if(this.startedDrawingRect){e=P(t.pageX,t.pageY,this.canvas);this.createdDrawingRect||(this.createdDrawingRect=!0,this.eventSpot=this.createRect(),this.eventSpot.x=this.x/this.canvasWidth*100,this.eventSpot.y=this.y/this.canvasHeight*100,this.eventSpot.x=Math.round(1e3*this.eventSpot.x)/1e3,this.eventSpot.y=Math.round(1e3*this.eventSpot.y)/1e3,this.redraw(),this.redrawEl=H('.imp-editor-shape[data-id="'+this.eventSpot.id+'"]'));w={x:this.dx,y:this.dy};if(100<this.eventSpot.x+w.x&&(w.x=100-this.eventSpot.x),100<this.eventSpot.y+w.y&&(w.y=100-this.eventSpot.y),this.drawRectWidth=w.x,this.drawRectHeight=w.y,this.shiftKeyDown){c=this.canvasWidth/this.canvasHeight;this.drawRectHeight=this.drawRectWidth*c}this.redrawEl.css({width:this.drawRectWidth+"%",height:this.drawRectHeight+"%"})}else if(this.startedDrawingOval){e=P(t.pageX,t.pageY,this.canvas);this.createdDrawingOval||(this.createdDrawingOval=!0,this.eventSpot=this.createOval(),this.eventSpot.x=this.x/this.canvasWidth*100,this.eventSpot.y=this.y/this.canvasHeight*100,this.eventSpot.x=Math.round(1e3*this.eventSpot.x)/1e3,this.eventSpot.y=Math.round(1e3*this.eventSpot.y)/1e3,this.eventSpot.x_image_background=this.eventSpot.x,this.eventSpot.y_image_background=this.eventSpot.y,this.redraw(),this.redrawEl=H('.imp-editor-shape[data-id="'+this.eventSpot.id+'"]'));w={x:this.dx,y:this.dy};if(100<this.eventSpot.x+w.x&&(w.x=100-this.eventSpot.x),100<this.eventSpot.y+w.y&&(w.y=100-this.eventSpot.y),this.drawRectWidth=w.x,this.drawRectHeight=w.y,this.shiftKeyDown){c=this.canvasWidth/this.canvasHeight;this.drawRectHeight=this.drawRectWidth*c}this.redrawEl.css({width:this.drawRectWidth+"%",height:this.drawRectHeight+"%"})}else{if(this.mouseDownWhileDrawingPoly)return this.polyPoints[this.polyPoints.length-1].x=this.x/this.zoom,this.polyPoints[this.polyPoints.length-1].y=this.y/this.zoom,void this.redrawTempPoly();if(this.translatingControlPoint){if(!this.startedTranslatingControlPoint){this.startedTranslatingControlPoint=!0,H(t.target).closest(".imp-editor-shape").find(".imp-selection").hide(),H(t.target).closest(".imp-editor-shape").css({left:0,top:0,width:"100%",height:"100%"}),H(t.target).closest(".imp-editor-shape").find(".imp-editor-poly-svg")[0].setAttribute("viewBox","0 0 "+T.general.width+" "+T.general.height);for(var I=0;I<this.selectedSpot.points.length;I++)H('.imp-editor-shape[data-id="'+this.selectedSpot.id+'"]').find('.imp-poly-control-point[data-index="'+I+'"]').css({left:W(this.selectedSpot.points[I],this.selectedSpot).x+"%",top:W(this.selectedSpot.points[I],this.selectedSpot).y+"%"})}W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).x+this.dx<0&&(this.dx=-W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).x),100<W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).x+this.dx&&(this.dx=100-W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).x),W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).y+this.dy<0&&(this.dy=-W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).y),100<W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).y+this.dy&&(this.dy=100-W({x:this.translatedPointX,y:this.translatedPointY},this.selectedSpot).y);p=this.dx/(this.selectedSpot.width/100*this.canvasWidth/this.canvasWidth),d=this.dy/(this.selectedSpot.height/100*this.canvasHeight/this.canvasHeight);this.selectedSpot.points[this.translatedPointIndex].x=this.translatedPointX+p,this.selectedSpot.points[this.translatedPointIndex].y=this.translatedPointY+d,this.translatedPoint.css({left:W(this.selectedSpot.points[this.translatedPointIndex],this.selectedSpot).x+"%",top:W(this.selectedSpot.points[this.translatedPointIndex],this.selectedSpot).y+"%"});for(m="",_=0;_<this.selectedSpot.points.length;_++){u=W(this.selectedSpot.points[_],this.selectedSpot);m+=(a=this.selectedSpot.default_style.stroke_width+u.x/100*(T.general.width-2*this.selectedSpot.default_style.stroke_width))+","+(n=this.selectedSpot.default_style.stroke_width+u.y/100*(T.general.height-2*this.selectedSpot.default_style.stroke_width))+" "}this.redrawPolygonEl.attr("points",m)}else this.selectedSpot&&"poly"==this.selectedSpot.type&&this.redrawSelectedPolyTempPoint(t)}}}},l.prototype.handleMouseUp=function(t){if(!z(T.editor.previewMode)){"imp-poly-tooltip-close-button"==H(t.target).attr("id")&&H("#imp-poly-tooltip").remove();var e=H(t.target).data("editor-object-type")||H(t.target).closest("[data-editor-object-type]").data("editor-object-type");if(this.startedDrawingSpot)(n=this.createSpot()).x=this.ix/this.canvasWidth*100,n.y=this.iy/this.canvasHeight*100,n.x=Math.round(1e3*n.x)/1e3,n.y=Math.round(1e3*n.y)/1e3,this.selectSpot(n.id),this.redraw(),this.addAction();else if(this.startedDrawingRect&&this.createdDrawingRect){var o=D(this.dx,this.dy);this.eventSpot.width=Math.round(1e3*this.drawRectWidth)/1e3,this.eventSpot.height=Math.round(1e3*this.drawRectHeight)/1e3,this.eventSpot.x_image_background=this.eventSpot.x,this.eventSpot.y_image_background=this.eventSpot.y,this.eventSpot.width_image_background=this.eventSpot.width,this.eventSpot.height_image_background=this.eventSpot.height,this.selectSpot(this.eventSpot.id),this.redraw(),this.addAction()}else if(this.startedDrawingOval&&this.createdDrawingOval){o=D(this.dx,this.dy);this.eventSpot.width=Math.round(1e3*this.drawRectWidth)/1e3,this.eventSpot.height=Math.round(1e3*this.drawRectHeight)/1e3,this.eventSpot.x_image_background=this.eventSpot.x,this.eventSpot.y_image_background=this.eventSpot.y,this.eventSpot.width_image_background=this.eventSpot.width,this.eventSpot.height_image_background=this.eventSpot.height,this.selectSpot(this.eventSpot.id),this.redraw(),this.addAction()}else if(this.finishedDrawingPoly){H("#temp-poly").remove();var i=this.createPoly(this.polyPoints);this.selectSpot(i.id),i.x_image_background=i.x,i.y_image_background=i.y,i.width_image_background=i.width,i.height_image_background=i.height,this.addAction(),this.redraw()}else if(this.startedDrawingText){(n=this.createText()).x=this.ix/this.canvasWidth*100,n.y=this.iy/this.canvasHeight*100,n.x=Math.round(1e3*n.x)/1e3,n.y=Math.round(1e3*n.y)/1e3,this.selectSpot(n.id),this.redraw(),this.addAction()}else if(this.startedMoving){o=D(this.selectedSpot.x+this.dx,this.selectedSpot.y+this.dy);"rect"!=this.selectedSpot.type&&"oval"!=this.selectedSpot.type&&"poly"!=this.selectedSpot.type||(100<o.x+this.selectedSpot.width&&(o.x=100-this.selectedSpot.width),100<o.y+this.selectedSpot.height&&(o.y=100-this.selectedSpot.height)),this.selectedSpot.x=Math.round(1e3*o.x)/1e3,this.selectedSpot.y=Math.round(1e3*o.y)/1e3,this.selectedSpot.x_image_background=this.selectedSpot.x,this.selectedSpot.y_image_background=this.selectedSpot.y,this.redraw(),this.addAction()}else if(this.startedTransforming&&this.didTransform)this.selectedSpot.x=Math.round(1e3*this.transformX)/1e3,this.selectedSpot.y=Math.round(1e3*this.transformY)/1e3,this.selectedSpot.width=Math.round(1e3*this.transformWidth)/1e3,this.selectedSpot.height=Math.round(1e3*this.transformHeight)/1e3,this.selectedSpot.x_image_background=this.selectedSpot.x,this.selectedSpot.y_image_background=this.selectedSpot.y,this.selectedSpot.width_image_background=this.selectedSpot.width,this.selectedSpot.height_image_background=this.selectedSpot.height,this.redraw(),this.addAction();else if(this.startedTransformingTooltip&&this.didTransformTooltip)this.selectedSpot.tooltip_style.width=this.transformingTooltipWidth,this.selectedSpot.tooltip_style.auto_width=0,this.addAction(),this.redraw();else if(this.translatingControlPoint){this.dx,this.selectedSpot.width,this.canvasWidth,this.canvasWidth,this.dy,this.selectedSpot.height,this.canvasHeight,this.canvasHeight;this.updateBoundingBoxForPolygonSpot(this.selectedSpot),this.redraw(),this.addAction()}else if(this.startedSelecting)this.selectedSpot&&this.selectedSpot.id!=this.eventSpotId&&this.deselectSpot(),this.selectSpot(this.eventSpotId),this.redraw(),this.addAction();else if(this.shouldDeselectShape)this.deselectSpot(),this.redraw(),this.addAction();else if(this.movingTooltip){var r=this.redrawTooltip,s=0,a=0,n=this.selectedSpot,l=r.outerWidth()/this.canvasWidth*100,p=r.outerHeight()/this.canvasHeight*100,d=20/this.canvasWidth*100,c=20/this.canvasHeight*100,h=n.width,g=n.height,m=n.x,_=n.y;"spot"==n.type&&(h=n.width/this.canvasWidth*100,g=n.height/this.canvasHeight*100,m=n.x-h/2,_=n.y-g/2,z(n.default_style.icon_is_pin)&&(_-=g/2)),"top"==this.movingTooltipPosition&&(s=m+h/2-l/2,a=_-p-c),"bottom"==this.movingTooltipPosition&&(s=m+h/2-l/2,a=_+g+c),"left"==this.movingTooltipPosition&&(s=m-l-d,a=_+g/2-p/2),"right"==this.movingTooltipPosition&&(s=m+h+d,a=_+g/2-p/2);var u=s+l/2,w=a+p/2,y=(this.redrawTooltip.position().left+this.redrawTooltip.outerWidth()/2)/this.canvasWidth*100-u,S=(this.redrawTooltip.position().top+this.redrawTooltip.outerHeight()/2)/this.canvasHeight*100-w;this.selectedSpot.tooltip_style.offset_x=y,this.selectedSpot.tooltip_style.offset_y=S,this.selectedSpot.tooltip_style.position=this.movingTooltipPosition,this.addAction(),this.redraw()}if(10==e){if(H.wcpEditorIsFloatingWindowOpen())return H.wcpEditorCloseFloatingWindow(),void this.redraw();var f=(F=H('[data-editor-object-type="10"]').parent()).offset().left,v=F.offset().top,b=F.width(),x=H.wcpFormGenerateHTMLForForm("Tooltip Style"),C={x:Math.round(f+b+10),y:Math.round(v),padding:!0,title:"Tooltip Style",width:300,content:x};return H.wcpEditorCreateFloatingWindow(C),this.updateShapesForm(),void this.redraw()}if(11==e)return H.wcpEditorIsFloatingWindowOpen()&&H.wcpEditorCloseFloatingWindow(),T.editor.transform_tooltip_mode=1,this.tooltipTransformMode=!0,this.transformingTooltipStartingWidth=H("#imp-editor-shape-tooltip").outerWidth(),void this.redraw();if(12!=e){if(13==e)return T.editor.transform_tooltip_mode=0,this.tooltipTransformMode=!1,this.addAction(),void this.redraw();if(14==e)return this.selectedSpot.tooltip_style.offset_x=0,this.selectedSpot.tooltip_style.offset_y=0,this.selectedSpot.tooltip_style.width=this.transformingTooltipStartingWidth,this.addAction(),void this.redraw();this.draggingCanvas=!1,this.startedSelecting=!1,this.startedMoving=!1,this.startedTransforming=!1,this.didTransform=!1,this.startedTransformingTooltip=!1,this.didTransformTooltip=!1,this.transformDirection=0,this.startedDrawingSpot=!1,this.startedDrawingText=!1,this.startedDrawingRect=!1,this.createdDrawingRect=!1,this.startedDrawingOval=!1,this.createdDrawingOval=!1,this.startedDrawingPoly=!1,this.finishedDrawingPoly=!1,this.mouseDownWhileDrawingPoly=!1,this.translatingControlPoint=!1,this.startedTranslatingControlPoint=!1,this.shouldDeselectShape=!1,this.startedSelectingTooltip=!1,this.movingTooltip=!1}else{if(H.wcpEditorIsFloatingWindowOpen())return H.wcpEditorCloseFloatingWindow(),void this.redraw();var F;f=(F=H('[data-editor-object-type="10"]').parent()).offset().left,v=F.offset().top,b=F.width();H.squaresInitWithSettings(H("#imp-editor-shape-tooltip-content-wrap"),this.selectedSpot.tooltip_content.squares_settings);x=H.squaresGetEditorWindowContents(),C={x:Math.round(f+b+10),y:Math.round(v),padding:!1,title:"Tooltip Content",content:x,width:394};H.wcpEditorCreateFloatingWindow(C)}}},l.prototype.handleKeyDown=function(t){var e=y;return 0<H("input:focus").length||0<H("textarea:focus").length||(32==t.keyCode&&(this.spaceKeyDown=!0,this.enterCanvasDragMode(),e=!1),91==t.keyCode&&(e=this.commandKeyDown=!0),17==t.keyCode&&(e=this.ctrlKeyDown=!0),16==t.keyCode&&(e=this.shiftKeyDown=!0),187!=t.keyCode&&107!=t.keyCode||(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomIn(),e=!1),189!=t.keyCode&&109!=t.keyCode||(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomOut(),e=!1),48==t.keyCode&&(this.ctrlKeyDown||this.commandKeyDown)&&(this.zoomReset(),e=!1),e)},l.prototype.handleKeyUp=function(t){var e=!1;if(0<H("input:focus").length||0<H("textarea:focus").length)return!0;if(32==t.keyCode&&(this.spaceKeyDown=!1,this.exitCanvasDragMode(),e=!1),91==t.keyCode&&(e=!(this.commandKeyDown=!1)),17==t.keyCode&&(e=!(this.ctrlKeyDown=!1)),16==t.keyCode&&(e=!(this.shiftKeyDown=!1)),27==t.keyCode&&(this.drawingPoly?(this.drawingPoly=!1,this.startedDrawingPoly=!1,this.mouseDownWhileDrawingPoly=!1,H("#temp-poly").remove()):this.tooltipTransformMode?(this.tooltipTransformMode=!1,T.editor.transform_tooltip_mode=0,this.redraw()):H.wcpEditorCloseModal()),13==t.keyCode)if(this.drawingPoly){this.drawingPoly=!1,this.finishedDrawingPoly=!1,H("#temp-poly").remove();var o=this.createPoly(this.polyPoints);this.selectSpot(o.id),this.addAction(),this.redraw()}else this.tooltipTransformMode&&(this.tooltipTransformMode=!1,T.editor.transform_tooltip_mode=0,this.redraw());return 46==t.keyCode&&(e=!0,this.selectedSpot&&(m=_.getIndexOfSpotWithId(this.selectedSpot.id),H.wcpEditorPresentModal({name:"confirm-delete-shape",title:"Confirm Delete",buttons:[{name:"cancel",title:"Cancel",class:""},{name:"primary",title:"Delete",class:"danger"}],body:"Delete this shape?"}))),H("#input-icon-search").is(":focus")&&H.wcpFontawesomeSearch(H("#input-icon-search").val()),e},l.prototype.getIndexOfSpotWithId=function(t){for(var e=0;e<T.spots.length;e++)if(T.spots[e].id==t)return e},l.prototype.selectSpot=function(t){T.editor.selected_shape=t},l.prototype.deselectSpot=function(){H.wcpEditorCloseFloatingWindow(),T.editor.selected_shape=-1,T.editor.transform_tooltip_mode=0,this.tooltipTransformMode=!1},l.prototype.createIdForSpot=function(){var t=0,e=!1;do{t="spot-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForRect=function(){var t=0,e=!1;do{t="rect-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForOval=function(){var t=0,e=!1;do{t="oval-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForPoly=function(){var t=0,e=!1;do{t="poly-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForText=function(){var t=0,e=!1;do{t="text-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForPath=function(){var t=0,e=!1;do{t="path-"+Math.floor(9999*Math.random()),e=!1;for(var o=0;o<T.spots.length;o++)if(T.spots[o].id==t){e=!0;break}}while(e);return t},l.prototype.createIdForLayer=function(){for(var t=0,e=0;e<T.layers.layers_list.length;e++)T.layers.layers_list[e].id>t&&(t=T.layers.layers_list[e].id);return++t},l.prototype.createTitleForSpot=function(){var t="Spot "+T.editor.shapeCounter.spots;return T.editor.shapeCounter.spots++,t},l.prototype.createTitleForRect=function(){var t="Rect "+T.editor.shapeCounter.rects;return T.editor.shapeCounter.rects++,t},l.prototype.createTitleForOval=function(){var t="Oval "+T.editor.shapeCounter.ovals;return T.editor.shapeCounter.ovals++,t},l.prototype.createTitleForPoly=function(){var t="Poly "+T.editor.shapeCounter.polys;return T.editor.shapeCounter.polys++,t},l.prototype.createTitleForText=function(){var t="Text "+T.editor.shapeCounter.texts;return T.editor.shapeCounter.texts++,t},l.prototype.createTitleForPath=function(){var t="Path "+T.editor.shapeCounter.paths;return T.editor.shapeCounter.paths++,t},l.prototype.createSpot=function(){var t=H.extend(!0,{},f);return t.type="spot",t.id=this.createIdForSpot(),t.title=this.createTitleForSpot(),t.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.title,z(T.layers.enable_layers)?t.layerID=T.editor.currentLayer:T.layers.layers_list[0]?t.layerID=T.layers.layers_list[0].id:t.layerID=0,T.spots.push(t),t},l.prototype.createRect=function(){var t=H.extend(!0,{},f);return t.type="rect",t.default_style.border_radius=10,t.mouseover_style.border_radius=10,t.id=this.createIdForRect(),t.title=this.createTitleForRect(),t.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.title,z(T.layers.enable_layers)?t.layerID=T.editor.currentLayer:T.layers.layers_list[0]?t.layerID=T.layers.layers_list[0].id:t.layerID=0,T.spots.push(t),t},l.prototype.createOval=function(){var t=H.extend(!0,{},f);return t.type="oval",t.id=this.createIdForOval(),t.title=this.createTitleForOval(),t.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.title,z(T.layers.enable_layers)?t.layerID=T.editor.currentLayer:T.layers.layers_list[0]?t.layerID=T.layers.layers_list[0].id:t.layerID=0,T.spots.push(t),t},l.prototype.createPoly=function(t){var e=H.extend(!0,{},f);e.type="poly",e.id=this.createIdForPoly(),e.title=this.createTitleForPoly(),e.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=e.title;for(var o=99999,i=99999,r=0,s=0,a=0;a<t.length;a++){var n=t[a];n.x<o&&(o=n.x),n.x>r&&(r=n.x),n.y<i&&(i=n.y),n.y>s&&(s=n.y)}var l=r-o,p=s-i;e.x=o/this.canvasWidth*100*this.zoom,e.y=i/this.canvasHeight*100*this.zoom,e.width=l/this.canvasWidth*100*this.zoom,e.height=p/this.canvasHeight*100*this.zoom;for(a=0;a<t.length;a++)e.points.push({x:(t[a].x-o)/l*100,y:(t[a].y-i)/p*100});return z(T.layers.enable_layers)?e.layerID=T.editor.currentLayer:T.layers.layers_list[0]?e.layerID=T.layers.layers_list[0].id:e.layerID=0,T.spots.push(e),e},l.prototype.createText=function(){var t=H.extend(!0,{},f);return t.type="text",t.id=this.createIdForText(),t.title=this.createTitleForText(),t.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.title,z(T.layers.enable_layers)?t.layerID=T.editor.currentLayer:T.layers.layers_list[0]?t.layerID=T.layers.layers_list[0].id:t.layerID=0,T.spots.push(t),t},l.prototype.createPath=function(t,e,o,i){var r=H.extend(!0,{},f);r.type="path",r.id=this.createIdForPath(),r.title=this.createTitleForPath(),r.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=r.title,r.d=t;var s=H.svgPathParser(t);if(o!=y&&i!=y){for(var a=0;a<s.length;a++)for(var n=s[a],l=1;l<n.length;l++)n[l]+=l%2==0?i:o;r.d="";for(a=0;a<s.length;a++){var p,d,c=s[a];r.d+=c[0];for(l=1;l<c.length;l++)d=c[l],p=l%2!=0?" ":",",r.d+=p+d;r.d+=" "}}var h=9999,g=9999,m=0,_=0;for(a=0;a<s.length;a++)s[a][1]<h&&(h=s[a][1]),s[a][2]<g&&(g=s[a][2]),s[a][1]>m&&(m=s[a][1]),s[a][2]>_&&(_=s[a][2]);for(a=0;a<s.length;a++){c=s[a];r.vs.push([c[1],c[2]])}var u=m-h,w=_-g;return r.x=h/T.general.width*100,r.y=g/T.general.height*100,r.width=u/T.general.width*100,r.height=w/T.general.height*100,e!==y&&(r.connected_to=e,r.use_connected_shape_tooltip=1),z(T.layers.enable_layers)?r.layerID=T.editor.currentLayer:T.layers.layers_list[0]?r.layerID=T.layers.layers_list[0].id:r.layerID=0,T.spots.push(r),r},l.prototype.enterCanvasDragMode=function(){T.editor.state.dragging||(T.editor.state.dragging=!0,this.canvas.append('<div class="imp-editor-canvas-overlay" id="imp-editor-canvas-overlay-drag"></div>'))},l.prototype.exitCanvasDragMode=function(){T.editor.state.dragging&&(T.editor.state.dragging=!1,this.canvas.find("#imp-editor-canvas-overlay-drag").remove())},l.prototype.zoomIn=function(t){if(this.zoom*=2,T.editor.zoom=this.zoom,32<this.zoom)this.zoom=32;else{var e,o,i=0,r=0;if(t)i=this.ix,r=this.iy;else if(this.selectedSpot)r="spot"!=this.selectedSpot.type?(i=this.selectedSpot.x+this.selectedSpot.width/2,r=this.selectedSpot.y+this.selectedSpot.height/2,i=i/100*this.canvasWidth,r/100*this.canvasHeight):(i=this.selectedSpot.x/100*this.canvasWidth+this.selectedSpot.width/2,this.selectedSpot.y/100*this.canvasHeight+this.selectedSpot.height/2);else{var s=H("#wcp-editor-center"),a=P(s.offset().left+s.width()/2,s.offset().top+s.height()/2,this.canvas);i=a.x,r=a.y}e=this.canvasWidth/2-i,o=this.canvasHeight/2-r,this.canvasX+=e,this.canvasY+=o,this.redrawCanvas(),this.redraw()}},l.prototype.zoomOut=function(t){if(this.zoom/=2,T.editor.zoom=this.zoom,this.zoom<1)this.zoom=1,T.editor.zoom=1;else{var e,o,i=0,r=0;if(t)i=this.ix,r=this.iy;else{var s=H("#wcp-editor-center"),a=P(s.offset().left+s.width()/2,s.offset().top+s.height()/2,this.canvas);i=a.x,r=a.y}e=this.canvasWidth/2-i,o=this.canvasHeight/2-r,this.canvasX-=e/2,this.canvasY-=o/2,this.redrawCanvas(),this.redraw()}1==this.zoom&&(this.canvasX=0,this.canvasY=0,this.redrawCanvas())},l.prototype.zoomReset=function(){this.zoom=1,T.editor.zoom=this.zoom,this.canvasX=0,this.canvasY=0,this.redrawCanvas(),this.redraw()},l.prototype.shouldSelectPoly=function(t){for(var e,o=this,i=0;i<T.spots.length;i++)T.spots[i].id==t&&(e=T.spots[i]);var r=o.ix-e.x/100*o.canvasWidth,s=o.iy-e.y/100*o.canvasHeight;r=r/(e.width/100*o.canvasWidth)*100,s=s/(e.height/100*o.canvasHeight)*100;var a=new Array;for(i=0;i<e.points.length;i++)a.push([e.points[i].x,e.points[i].y]);return!!function(t,e){for(var o=t.x,i=t.y,r=!1,s=0,a=e.length-1;s<e.length;a=s++){var n=e[s][0],l=e[s][1],p=e[a][0],d=e[a][1];i<l!=i<d&&o<(p-n)*(i-l)/(d-l)+n&&(r=!r)}return r}({x:r,y:s},a)},l.prototype.placePointForTempPoly=function(t,e){this.polyPoints.push({x:t/this.zoom,y:e/this.zoom})},l.prototype.redrawTempPoly=function(){for(var t=this,e='<polygon points="',o=0;o<t.polyPoints.length;o++){e+=t.polyPoints[o].x*t.zoom+","+t.polyPoints[o].y*t.zoom+" "}e+='" />';for(o=0;o<t.polyPoints.length;o++){e+='<circle cx="'+t.polyPoints[o].x*t.zoom+'" cy="'+t.polyPoints[o].y*t.zoom+'" r="4" data-index="'+o+'" />'}0==H("#temp-poly").length&&H("#imp-editor-shapes-container").append('<svg id="temp-poly" width="'+t.canvasWidth+'px" height="'+t.canvasHeight+'px" viewBox="0 0 '+t.canvasWidth+" "+t.canvasHeight+'" version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>'),H("#temp-poly").html(e);e="";1!=localStorage["image-map-pro-seen-poly-tooltip"]&&(localStorage["image-map-pro-seen-poly-tooltip"]=1,e+='<div id="imp-poly-tooltip" style="left: '+t.polyPoints[0].x*t.zoom+"px; top: "+t.polyPoints[0].y*t.zoom+'px;">Click the first point or press ENTER to finish <i class="fa fa-times" aria-hidden="true" id="imp-poly-tooltip-close-button"></i></div>',H("#imp-editor-shapes-container").append(e),H("#imp-poly-tooltip").css({left:H("#imp-poly-tooltip").position().left-H("#imp-poly-tooltip").outerWidth()-20,top:H("#imp-poly-tooltip").position().top-H("#imp-poly-tooltip").outerHeight()/2}))},l.prototype.redrawSelectedPolyTempPoint=function(t){var e,o=this,i=o.selectedSpot.width/100*o.canvasWidth,r=o.selectedSpot.height/100*o.canvasHeight,s=(o.x-o.selectedSpot.x/100*o.canvasWidth)/i*100,a=(o.y-o.selectedSpot.y/100*o.canvasHeight)/r*100;(e=o.shouldShowTempControlPoint(s,a,o.selectedSpot.points,t))?(o.tempControlPoint.show(),o.tempControlPointLine.show(),o.tempControlPoint.css({left:e.x+"%",top:e.y+"%"}),o.controlPointInsertionPointX=e.x,o.controlPointInsertionPointY=e.y):(o.tempControlPoint.hide(),o.tempControlPointLine.hide())},l.prototype.shouldShowTempControlPoint=function(t,e,o,i){if(7==(H(i.target).data("editor-object-type")||H(i.target).closest("[data-editor-object-type]").data("editor-object-type")))return!1;for(var r={x:t,y:e},s=9999,a=-1,n=!1,l=2e3/(this.canvasWidth*(this.selectedSpot.width/100)),p=0;p<o.length;p++){var d={x:o[p].x,y:o[p].y},c=y;c=o[p+1]?{x:o[p+1].x,y:o[p+1].y}:{x:o[0].x,y:o[0].y};var h=new b(r.x,r.y).closestPointOnLine(new b(d.x,d.y),new b(c.x,c.y)),g=Math.sqrt(Math.pow(r.x-h.x,2)+Math.pow(r.y-h.y,2));g<s&&g<l&&(s=g,a=this.tempControlPointIndex=p,n={x:h.x,y:h.y})}return-1!=a&&n},l.prototype.updateBoundingBoxForPolygonSpot=function(t){for(var e=99999,o=99999,i=-99999,r=-99999,s=0;s<t.points.length;s++){(d=t.points[s]).x<e&&(e=d.x),d.x>i&&(i=d.x),d.y<o&&(o=d.y),d.y>r&&(r=d.y)}var a,n,l=W({x:e,y:o},t),p=W({x:i,y:r},t);for(s=0;s<t.points.length;s++){var d,c=W(d=t.points[s],t),h=(a=c,n={x:l.x,y:l.y,width:p.x-l.x,height:p.y-l.y},{x:(a.x-n.x)/n.width*100,y:(a.y-n.y)/n.height*100});d.x=h.x,d.y=h.y}t.x=l.x,t.y=l.y,t.width=p.x-l.x,t.height=p.y-l.y},l.prototype.updateShapesList=function(){for(var t=[],e=T.spots.length-1;0<=e;e--){var o=T.spots[e];z(T.layers.enable_layers)&&parseInt(o.layerID,10)!=parseInt(T.editor.currentLayer,10)||t.push({id:o.id,title:o.title})}H.wcpEditorSetListItems(t),H.wcpEditorSelectListItem(T.editor.selected_shape)},l.prototype.launchTooltipContentBuilder=function(){if(0==H("#imp-editor-tooltip-content-builder-wrap").length){H("body").append('<div id="imp-editor-tooltip-content-builder-wrap">   <div id="imp-editor-tooltip-content-builder-background"></div>   <div id="imp-editor-tooltip-content-builder-close"><i class="fa fa-times" aria-hidden="true"></i></div>   <div id="imp-editor-tooltip-content-builder-tooltip-wrap" class="squares">       <div id="imp-editor-tooltip-content-builder" class="squares"></div>   </div>   <div id="imp-editor-tooltip-content-builder-description">       <p>Press the Done button when you are done editing, or click the Close button in the upper-right corner.</p>   </div>   <div class="wcp-editor-control-button" id="imp-editor-done-editing-tooltip">Done</div></div>')}else H("#imp-editor-tooltip-content-builder-wrap").show();setTimeout(function(){H("#imp-editor-tooltip-content-builder-wrap").addClass("imp-visible")},10);var t=this.selectedSpot.tooltip_style.width,e=E(this.selectedSpot.tooltip_style.background_color),o="rgba("+e.r+", "+e.g+", "+e.b+", "+this.selectedSpot.tooltip_style.background_opacity+")";H("#imp-editor-tooltip-content-builder-tooltip-wrap").css({width:t,background:o}),H.squaresInitWithSettings(H("#imp-editor-tooltip-content-builder"),this.selectedSpot.tooltip_content.squares_settings),H.squaresShowEditorWindow(20,20)},l.prototype.doneEditingTooltip=function(){var t=H.squaresGetCurrentSettings(H("#imp-editor-tooltip-content-builder"));H.squaresGenerateHTML(H("#imp-editor-tooltip-content-builder"));this.selectedSpot.tooltip_content.squares_settings=t,this.redraw()},l.prototype.processNewLayerImage=function(t,e){var o=new Image;o.src=t,p(o,function(){},function(){e(!0,o.naturalWidth,o.naturalHeight)},function(){e(!1)})},l.prototype.getCompressedSettings=function(){for(var t=H.extend(!0,{},T),e=[],o=0;o<t.spots.length;o++)e[o]=H.wcpCompress(t.spots[o],f),e[o].x=Math.round(1e3*e[o].x)/1e3,e[o].y=Math.round(1e3*e[o].y)/1e3,e[o].width&&(e[o].width=Math.round(1e3*e[o].width)/1e3),e[o].height&&(e[o].height=Math.round(1e3*e[o].height)/1e3);return(t=H.wcpCompress(T,S)).spots=e,t},l.prototype.updateShapesForm=function(){var t=this.getIndexOfSpotWithId(T.editor.selected_shape),e=T.spots[t];if(e){if(H.wcpFormSetControlValue("Shape Settings","shape_title",e.title),H.wcpFormSetControlValue("Shape Settings","x",e.x),H.wcpFormSetControlValue("Shape Settings","y",e.y),H.wcpFormSetControlValue("Shape Settings","width",e.width),H.wcpFormSetControlValue("Shape Settings","height",e.height),H.wcpFormSetControlValue("Shape Settings","connected_to",e.connected_to),H.wcpFormSetControlValue("Shape Settings","use_connected_shape_tooltip",e.use_connected_shape_tooltip),H.wcpFormSetControlValue("Shape Settings","text",e.text),H.wcpFormSetControlValue("Shape Settings","static",e.static),H.wcpFormSetControlValue("Shape Settings","text",e.text.text),H.wcpFormSetControlValue("Shape Settings","font_family",e.text.font_family),H.wcpFormSetControlValue("Shape Settings","font_size",e.text.font_size),H.wcpFormSetControlValue("Shape Settings","font_weight",e.text.font_weight),H.wcpFormSetControlValue("Shape Settings","text_color",e.text.text_color),H.wcpFormSetControlValue("Shape Settings","text_opacity",e.text.text_opacity),H.wcpFormSetControlValue("Shape Settings","click",e.actions.click),H.wcpFormSetControlValue("Shape Settings","link",e.actions.link),H.wcpFormSetControlValue("Shape Settings","script",e.actions.script),H.wcpFormSetControlValue("Shape Settings","open_link_in_new_window",e.actions.open_link_in_new_window),H.wcpFormSetControlValue("Shape Settings","use_icon",e.default_style.use_icon),H.wcpFormSetControlValue("Shape Settings","icon_type",e.default_style.icon_type),H.wcpFormSetControlValue("Shape Settings","icon_svg_path",e.default_style.icon_svg_path),H.wcpFormSetControlValue("Shape Settings","icon_svg_viewbox",e.default_style.icon_svg_viewbox),H.wcpFormSetControlValue("Shape Settings","icon_url",e.default_style.icon_url),H.wcpFormSetControlValue("Shape Settings","icon_is_pin",e.default_style.icon_is_pin),H.wcpFormSetControlValue("Shape Settings","icon_shadow",e.default_style.icon_shadow),H.wcpFormSetControlValue("Shape Settings","opacity",e.default_style.opacity),H.wcpFormSetControlValue("Shape Settings","icon_fill",e.default_style.icon_fill),H.wcpFormSetControlValue("Shape Settings","border_radius",e.default_style.border_radius),H.wcpFormSetControlValue("Shape Settings","background_type",e.default_style.background_type),H.wcpFormSetControlValue("Shape Settings","background_image_url",e.default_style.background_image_url),H.wcpFormSetControlValue("Shape Settings","background_image_opacity",e.default_style.background_image_opacity),H.wcpFormSetControlValue("Shape Settings","background_image_scale",e.default_style.background_image_scale),H.wcpFormSetControlValue("Shape Settings","background_image_offset_x",e.default_style.background_image_offset_x),H.wcpFormSetControlValue("Shape Settings","background_image_offset_y",e.default_style.background_image_offset_y),H.wcpFormSetControlValue("Shape Settings","background_color",e.default_style.background_color),H.wcpFormSetControlValue("Shape Settings","background_opacity",e.default_style.background_opacity),H.wcpFormSetControlValue("Shape Settings","border_width",e.default_style.border_width),H.wcpFormSetControlValue("Shape Settings","border_style",e.default_style.border_style),H.wcpFormSetControlValue("Shape Settings","border_color",e.default_style.border_color),H.wcpFormSetControlValue("Shape Settings","border_opacity",e.default_style.border_opacity),H.wcpFormSetControlValue("Shape Settings","stroke_color",e.default_style.stroke_color),H.wcpFormSetControlValue("Shape Settings","stroke_opacity",e.default_style.stroke_opacity),H.wcpFormSetControlValue("Shape Settings","stroke_width",e.default_style.stroke_width),H.wcpFormSetControlValue("Shape Settings","stroke_dasharray",e.default_style.stroke_dasharray),H.wcpFormSetControlValue("Shape Settings","stroke_linecap",e.default_style.stroke_linecap),H.wcpFormSetControlValue("Shape Settings","mouseover_opacity",e.mouseover_style.opacity),H.wcpFormSetControlValue("Shape Settings","mouseover_icon_fill",e.mouseover_style.icon_fill),H.wcpFormSetControlValue("Shape Settings","mouseover_border_radius",e.mouseover_style.border_radius),H.wcpFormSetControlValue("Shape Settings","mouseover_background_image_url",e.mouseover_style.background_image_url),H.wcpFormSetControlValue("Shape Settings","mouseover_background_image_opacity",e.mouseover_style.background_image_opacity),H.wcpFormSetControlValue("Shape Settings","mouseover_background_image_scale",e.mouseover_style.background_image_scale),H.wcpFormSetControlValue("Shape Settings","mouseover_background_image_offset_x",e.mouseover_style.background_image_offset_x),H.wcpFormSetControlValue("Shape Settings","mouseover_background_image_offset_y",e.mouseover_style.background_image_offset_y),H.wcpFormSetControlValue("Shape Settings","mouseover_background_color",e.mouseover_style.background_color),H.wcpFormSetControlValue("Shape Settings","mouseover_background_opacity",e.mouseover_style.background_opacity),H.wcpFormSetControlValue("Shape Settings","mouseover_border_width",e.mouseover_style.border_width),H.wcpFormSetControlValue("Shape Settings","mouseover_border_style",e.mouseover_style.border_style),H.wcpFormSetControlValue("Shape Settings","mouseover_border_color",e.mouseover_style.border_color),H.wcpFormSetControlValue("Shape Settings","mouseover_border_opacity",e.mouseover_style.border_opacity),H.wcpFormSetControlValue("Shape Settings","mouseover_stroke_color",e.mouseover_style.stroke_color),H.wcpFormSetControlValue("Shape Settings","mouseover_stroke_opacity",e.mouseover_style.stroke_opacity),H.wcpFormSetControlValue("Shape Settings","mouseover_stroke_width",e.mouseover_style.stroke_width),H.wcpFormSetControlValue("Shape Settings","mouseover_stroke_dasharray",e.mouseover_style.stroke_dasharray),H.wcpFormSetControlValue("Shape Settings","mouseover_stroke_linecap",e.mouseover_style.stroke_linecap),H.wcpFormSetControlValue("Tooltip Style","tooltip_border_radius",e.tooltip_style.border_radius,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_padding",e.tooltip_style.padding,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_background_color",e.tooltip_style.background_color,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_background_opacity",e.tooltip_style.background_opacity,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_position",e.tooltip_style.position,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_width",e.tooltip_style.width,!0),H.wcpFormSetControlValue("Tooltip Style","tooltip_auto_width",e.tooltip_style.auto_width,!0),H.wcpFormSetControlValue("Shape Settings","enable_tooltip",e.tooltip.enable_tooltip),t==this.shapesFormSpotIndex)return;this.shapesFormSpotIndex=t;var o=H.wcpFormGenerateHTMLForForm("Shape Settings");H.wcpEditorSetObjectSettingsContent(o),H.wcpFormUpdateForm("Shape Settings");for(var i='<option value="">(Not Connected)</option>',r=0;r<T.spots.length;r++)T.spots[r].id!=T.editor.selected_shape&&""==T.spots[r].connected_to&&(i+='<option value="'+T.spots[r].id+'">'+T.spots[r].title+"</option>");H("#wcp-form-form-control-connected_to select").html(i),H("#wcp-form-form-control-connected_to select").val(e.connected_to)}else this.shapesFormSpotIndex=-1,H.wcpEditorSetObjectSettingsContent('<div id="imp-editor-no-shape-selected-wrap"><span>No shape selected</span></div>')},l.prototype.updateShapesFormState=function(){var t=this.getIndexOfSpotWithId(T.editor.selected_shape),e=T.spots[t];e&&(z(e.tooltip.enable_tooltip)?(H.wcpFormShowControl("Shape Settings","reset_tooltip_position"),H.wcpFormShowControl("Shape Settings","reset_tooltip_size"),H.wcpFormShowControl("Shape Settings","edit_tooltip_style"),H.wcpFormShowControl("Shape Settings","edit_tooltip_position"),H.wcpFormShowControl("Shape Settings","edit_tooltip_content")):(H.wcpFormHideControl("Shape Settings","reset_tooltip_position"),H.wcpFormHideControl("Shape Settings","reset_tooltip_size"),H.wcpFormHideControl("Shape Settings","edit_tooltip_style"),H.wcpFormHideControl("Shape Settings","edit_tooltip_position"),H.wcpFormHideControl("Shape Settings","edit_tooltip_content")),"spot"==e.type&&(H.wcpFormHideControlsGroup("Shape Settings","text"),H.wcpFormHideControl("Shape Settings","stroke_color"),H.wcpFormHideControl("Shape Settings","stroke_opacity"),H.wcpFormHideControl("Shape Settings","stroke_width"),H.wcpFormHideControl("Shape Settings","stroke_dasharray"),H.wcpFormHideControl("Shape Settings","stroke_linecap"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_color"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_width"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_dasharray"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_linecap")),"rect"==e.type&&(H.wcpFormHideControlsGroup("Shape Settings","text"),H.wcpFormHideControlsGroup("Shape Settings","icon"),H.wcpFormHideControl("Shape Settings","icon_fill"),H.wcpFormHideControl("Shape Settings","mouseover_icon_fill"),H.wcpFormHideControl("Shape Settings","stroke_color"),H.wcpFormHideControl("Shape Settings","stroke_opacity"),H.wcpFormHideControl("Shape Settings","stroke_width"),H.wcpFormHideControl("Shape Settings","stroke_dasharray"),H.wcpFormHideControl("Shape Settings","stroke_linecap"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_color"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_width"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_dasharray"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_linecap")),"oval"==e.type&&(H.wcpFormHideControlsGroup("Shape Settings","text"),H.wcpFormHideControlsGroup("Shape Settings","icon"),H.wcpFormHideControl("Shape Settings","icon_fill"),H.wcpFormHideControl("Shape Settings","mouseover_icon_fill"),H.wcpFormHideControl("Shape Settings","border_radius"),H.wcpFormHideControl("Shape Settings","mouseover_border_radius"),H.wcpFormHideControl("Shape Settings","stroke_color"),H.wcpFormHideControl("Shape Settings","stroke_opacity"),H.wcpFormHideControl("Shape Settings","stroke_width"),H.wcpFormHideControl("Shape Settings","stroke_dasharray"),H.wcpFormHideControl("Shape Settings","stroke_linecap"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_color"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_width"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_dasharray"),H.wcpFormHideControl("Shape Settings","mouseover_stroke_linecap")),"poly"!=e.type&&"path"!=e.type||(H.wcpFormHideControlsGroup("Shape Settings","text"),H.wcpFormHideControlsGroup("Shape Settings","icon"),H.wcpFormHideControl("Shape Settings","icon_fill"),H.wcpFormHideControl("Shape Settings","mouseover_icon_fill"),H.wcpFormHideControl("Shape Settings","opacity"),H.wcpFormHideControl("Shape Settings","border_radius"),H.wcpFormHideControl("Shape Settings","border_width"),H.wcpFormHideControl("Shape Settings","border_style"),H.wcpFormHideControl("Shape Settings","border_color"),H.wcpFormHideControl("Shape Settings","border_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_border_radius"),H.wcpFormHideControl("Shape Settings","mouseover_border_width"),H.wcpFormHideControl("Shape Settings","mouseover_border_style"),H.wcpFormHideControl("Shape Settings","mouseover_border_color"),H.wcpFormHideControl("Shape Settings","mouseover_border_opacity")),"text"==e.type&&(H.wcpFormHideControl("Shape Settings","width"),H.wcpFormHideControl("Shape Settings","height"),H.wcpFormHideControl("Shape Settings","connected_to"),H.wcpFormHideControlsGroup("Shape Settings","actions"),H.wcpFormHideControlsGroup("Shape Settings","icon"),H.wcpFormHideControlsGroup("Shape Settings","default_style"),H.wcpFormHideControlsGroup("Shape Settings","mouseover_style"),H.wcpFormHideControlsGroup("Shape Settings","tooltip"),H.wcpFormShowControlsGroup("Shape Settings","text")),"color"==e.default_style.background_type?(H.wcpFormHideControl("Shape Settings","background_image_url"),H.wcpFormHideControl("Shape Settings","background_image_opacity"),H.wcpFormHideControl("Shape Settings","background_image_scale"),H.wcpFormHideControl("Shape Settings","background_image_offset_x"),H.wcpFormHideControl("Shape Settings","background_image_offset_y"),H.wcpFormHideControl("Shape Settings","mouseover_background_image_url"),H.wcpFormHideControl("Shape Settings","mouseover_background_image_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_background_image_scale"),H.wcpFormHideControl("Shape Settings","mouseover_background_image_offset_x"),H.wcpFormHideControl("Shape Settings","mouseover_background_image_offset_y"),H.wcpFormShowControl("Shape Settings","background_color"),H.wcpFormShowControl("Shape Settings","background_opacity"),H.wcpFormShowControl("Shape Settings","mouseover_background_color"),H.wcpFormShowControl("Shape Settings","mouseover_background_opacity")):(H.wcpFormShowControl("Shape Settings","background_image_url"),H.wcpFormShowControl("Shape Settings","background_image_opacity"),H.wcpFormShowControl("Shape Settings","background_image_scale"),H.wcpFormShowControl("Shape Settings","background_image_offset_x"),H.wcpFormShowControl("Shape Settings","background_image_offset_y"),H.wcpFormShowControl("Shape Settings","mouseover_background_image_url"),H.wcpFormShowControl("Shape Settings","mouseover_background_image_opacity"),H.wcpFormShowControl("Shape Settings","mouseover_background_image_scale"),H.wcpFormShowControl("Shape Settings","mouseover_background_image_offset_x"),H.wcpFormShowControl("Shape Settings","mouseover_background_image_offset_y"),H.wcpFormHideControl("Shape Settings","background_color"),H.wcpFormHideControl("Shape Settings","background_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_background_color"),H.wcpFormHideControl("Shape Settings","mouseover_background_opacity")),"spot"==e.type&&(z(e.default_style.use_icon)?(H.wcpFormShowControl("Shape Settings","choose_icon_from_library"),H.wcpFormShowControl("Shape Settings","icon_type"),H.wcpFormShowControl("Shape Settings","icon_url"),H.wcpFormShowControl("Shape Settings","icon_is_pin"),H.wcpFormShowControl("Shape Settings","icon_shadow"),H.wcpFormShowControl("Shape Settings","icon_fill"),H.wcpFormHideControl("Shape Settings","border_radius"),H.wcpFormHideControl("Shape Settings","background_type"),H.wcpFormHideControl("Shape Settings","background_color"),H.wcpFormHideControl("Shape Settings","background_opacity"),H.wcpFormHideControl("Shape Settings","border_width"),H.wcpFormHideControl("Shape Settings","border_style"),H.wcpFormHideControl("Shape Settings","border_color"),H.wcpFormHideControl("Shape Settings","border_opacity"),H.wcpFormShowControl("Shape Settings","mouseover_icon_fill"),H.wcpFormHideControl("Shape Settings","mouseover_border_radius"),H.wcpFormHideControl("Shape Settings","mouseover_background_color"),H.wcpFormHideControl("Shape Settings","mouseover_background_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_border_width"),H.wcpFormHideControl("Shape Settings","mouseover_border_style"),H.wcpFormHideControl("Shape Settings","mouseover_border_color"),H.wcpFormHideControl("Shape Settings","mouseover_border_opacity")):(H.wcpFormHideControl("Shape Settings","choose_icon_from_library"),H.wcpFormHideControl("Shape Settings","icon_type"),H.wcpFormHideControl("Shape Settings","icon_url"),H.wcpFormHideControl("Shape Settings","icon_is_pin"),H.wcpFormHideControl("Shape Settings","icon_shadow"),H.wcpFormHideControl("Shape Settings","icon_fill"),H.wcpFormShowControl("Shape Settings","border_radius"),H.wcpFormShowControl("Shape Settings","background_type"),H.wcpFormShowControl("Shape Settings","background_color"),H.wcpFormShowControl("Shape Settings","background_opacity"),H.wcpFormShowControl("Shape Settings","border_width"),H.wcpFormShowControl("Shape Settings","border_style"),H.wcpFormShowControl("Shape Settings","border_color"),H.wcpFormShowControl("Shape Settings","border_opacity"),H.wcpFormHideControl("Shape Settings","mouseover_icon_fill"),H.wcpFormShowControl("Shape Settings","mouseover_border_radius"),H.wcpFormShowControl("Shape Settings","mouseover_background_color"),H.wcpFormShowControl("Shape Settings","mouseover_background_opacity"),H.wcpFormShowControl("Shape Settings","mouseover_border_width"),H.wcpFormShowControl("Shape Settings","mouseover_border_style"),H.wcpFormShowControl("Shape Settings","mouseover_border_color"),H.wcpFormShowControl("Shape Settings","mouseover_border_opacity")),"library"==e.default_style.icon_type&&H.wcpFormHideControl("Shape Settings","icon_url"),"custom"==e.default_style.icon_type&&H.wcpFormHideControl("Shape Settings","choose_icon_from_library")),"follow-link"==e.actions.click?(H.wcpFormShowControl("Shape Settings","link"),H.wcpFormShowControl("Shape Settings","open_link_in_new_window")):(H.wcpFormHideControl("Shape Settings","link"),H.wcpFormHideControl("Shape Settings","open_link_in_new_window")),"run-script"==e.actions.click?H.wcpFormShowControl("Shape Settings","script"):H.wcpFormHideControl("Shape Settings","script"),""!=e.connected_to?(H.wcpFormShowControl("Shape Settings","use_connected_shape_tooltip"),z(e.use_connected_shape_tooltip)?H.wcpFormHideControlsGroup("Shape Settings","tooltip"):H.wcpFormShowControlsGroup("Shape Settings","tooltip")):H.wcpFormHideControl("Shape Settings","use_connected_shape_tooltip"))},l.prototype.updateImageMapForm=function(){H.wcpFormSetControlValue("Image Map Settings","image_map_name",T.general.name),H.wcpFormSetControlValue("Image Map Settings","image_map_shortcode",T.general.shortcode),H.wcpFormSetControlValue("Image Map Settings","image_map_width",T.general.width),H.wcpFormSetControlValue("Image Map Settings","image_map_height",T.general.height),H.wcpFormSetControlValue("Image Map Settings","responsive",T.general.responsive),H.wcpFormSetControlValue("Image Map Settings","preserve_quality",T.general.preserve_quality),H.wcpFormSetControlValue("Image Map Settings","center_image_map",T.general.center_image_map),H.wcpFormSetControlValue("Image Map Settings","image_url",T.image.url),H.wcpFormSetControlValue("Image Map Settings","pageload_animation",T.shapes.pageload_animation),H.wcpFormSetControlValue("Image Map Settings","glowing_shapes",T.shapes.glowing_shapes),H.wcpFormSetControlValue("Image Map Settings","glowing_shapes_color",T.shapes.glowing_shapes_color),H.wcpFormSetControlValue("Image Map Settings","glow_opacity",T.shapes.glow_opacity),H.wcpFormSetControlValue("Image Map Settings","stop_glowing_on_mouseover",T.shapes.stop_glowing_on_mouseover),H.wcpFormSetControlValue("Image Map Settings","enable_tooltips",T.tooltips.enable_tooltips),H.wcpFormSetControlValue("Image Map Settings","show_tooltips",T.tooltips.show_tooltips),H.wcpFormSetControlValue("Image Map Settings","show_title_on_mouseover",T.tooltips.show_title_on_mouseover),H.wcpFormSetControlValue("Image Map Settings","sticky_tooltips",T.tooltips.sticky_tooltips),H.wcpFormSetControlValue("Image Map Settings","constrain_tooltips",T.tooltips.constrain_tooltips),H.wcpFormSetControlValue("Image Map Settings","tooltip_animation",T.tooltips.tooltip_animation),H.wcpFormSetControlValue("Image Map Settings","fullscreen_tooltips",T.tooltips.fullscreen_tooltips),H.wcpFormSetControlValue("Image Map Settings","enable_fullscreen_mode",T.fullscreen.enable_fullscreen_mode),H.wcpFormSetControlValue("Image Map Settings","start_in_fullscreen_mode",T.fullscreen.start_in_fullscreen_mode),H.wcpFormSetControlValue("Image Map Settings","fullscreen_background",T.fullscreen.fullscreen_background),H.wcpFormSetControlValue("Image Map Settings","fullscreen_button_position",T.fullscreen.fullscreen_button_position),H.wcpFormSetControlValue("Image Map Settings","fullscreen_button_type",T.fullscreen.fullscreen_button_type),H.wcpFormSetControlValue("Image Map Settings","fullscreen_button_color",T.fullscreen.fullscreen_button_color),H.wcpFormSetControlValue("Image Map Settings","fullscreen_button_text_color",T.fullscreen.fullscreen_button_text_color),H.wcpFormSetControlValue("Image Map Settings","enable_zooming",T.zooming.enable_zooming),H.wcpFormSetControlValue("Image Map Settings","max_zoom",T.zooming.max_zoom),H.wcpFormSetControlValue("Image Map Settings","limit_max_zoom_to_image_size",T.zooming.limit_max_zoom_to_image_size),H.wcpFormSetControlValue("Image Map Settings","enable_navigator",T.zooming.enable_navigator),H.wcpFormSetControlValue("Image Map Settings","enable_zoom_buttons",T.zooming.enable_zoom_buttons),H.wcpFormSetControlValue("Image Map Settings","zoom_button_text_color",T.zooming.zoom_button_text_color),H.wcpFormSetControlValue("Image Map Settings","zoom_button_background_color",T.zooming.zoom_button_background_color),H.wcpFormSetControlValue("Image Map Settings","hold_ctrl_to_zoom",T.zooming.hold_ctrl_to_zoom),H.wcpFormSetControlValue("Image Map Settings","custom_css",T.custom_code.custom_css),H.wcpFormSetControlValue("Image Map Settings","custom_js",T.custom_code.custom_js),H.wcpFormSetControlValue("Image Map Settings","enable_layers",T.layers.enable_layers),H.wcpFormSetControlValue("Image Map Settings","layers_list",T.layers.layers_list);var t='<div data-imp-detached-menu="'+T.id+'"></div>';H.wcpFormSetControlValue("Image Map Settings","enable_shapes_menu",T.shapes_menu.enable_shapes_menu),H.wcpFormSetControlValue("Image Map Settings","detached_menu",T.shapes_menu.detached_menu),H.wcpFormSetControlValue("Image Map Settings","detached_menu_info",t),H.wcpFormSetControlValue("Image Map Settings","menu_position",T.shapes_menu.menu_position),H.wcpFormSetControlValue("Image Map Settings","enable_search",T.shapes_menu.enable_search),H.wcpFormSetControlValue("Image Map Settings","group_by_floor",T.shapes_menu.group_by_floor),H.wcpFormSetControlValue("Image Map Settings","hide_children_of_connected_shapes",T.shapes_menu.hide_children_of_connected_shapes),H.wcpFormUpdateForm("Image Map Settings")},l.prototype.updateImageMapFormState=function(){z(T.general.responsive)?(H.wcpFormHideControl("Image Map Settings","image_map_width"),H.wcpFormHideControl("Image Map Settings","image_map_height"),H.wcpFormHideControl("Image Map Settings","reset_size"),H.wcpFormShowControl("Image Map Settings","preserve_quality")):(H.wcpFormShowControl("Image Map Settings","image_map_width"),H.wcpFormShowControl("Image Map Settings","image_map_height"),H.wcpFormShowControl("Image Map Settings","reset_size"),H.wcpFormHideControl("Image Map Settings","preserve_quality")),z(T.fullscreen.enable_fullscreen_mode)?(H.wcpFormShowControl("Image Map Settings","start_in_fullscreen_mode"),H.wcpFormShowControl("Image Map Settings","fullscreen_background"),H.wcpFormShowControl("Image Map Settings","fullscreen_button_position"),H.wcpFormShowControl("Image Map Settings","fullscreen_button_type"),H.wcpFormShowControl("Image Map Settings","fullscreen_button_color"),H.wcpFormShowControl("Image Map Settings","fullscreen_button_text_color")):(H.wcpFormHideControl("Image Map Settings","start_in_fullscreen_mode"),H.wcpFormHideControl("Image Map Settings","fullscreen_background"),H.wcpFormHideControl("Image Map Settings","fullscreen_button_position"),H.wcpFormHideControl("Image Map Settings","fullscreen_button_type"),H.wcpFormHideControl("Image Map Settings","fullscreen_button_color"),H.wcpFormHideControl("Image Map Settings","fullscreen_button_text_color")),z(T.tooltips.enable_tooltips)?(H.wcpFormShowControl("Image Map Settings","show_tooltips"),H.wcpFormShowControl("Image Map Settings","sticky_tooltips"),H.wcpFormShowControl("Image Map Settings","constrain_tooltips"),H.wcpFormShowControl("Image Map Settings","tooltip_animation"),H.wcpFormShowControl("Image Map Settings","fullscreen_tooltips")):(H.wcpFormHideControl("Image Map Settings","show_tooltips"),H.wcpFormHideControl("Image Map Settings","sticky_tooltips"),H.wcpFormHideControl("Image Map Settings","constrain_tooltips"),H.wcpFormHideControl("Image Map Settings","tooltip_animation"),H.wcpFormHideControl("Image Map Settings","fullscreen_tooltips")),"click"==T.tooltips.show_tooltips?H.wcpFormShowControl("Image Map Settings","show_title_on_mouseover"):H.wcpFormHideControl("Image Map Settings","show_title_on_mouseover"),z(T.zooming.enable_zooming)?(H.wcpFormShowControl("Image Map Settings","max_zoom"),H.wcpFormShowControl("Image Map Settings","limit_max_zoom_to_image_size"),H.wcpFormShowControl("Image Map Settings","enable_zoom_buttons"),H.wcpFormShowControl("Image Map Settings","enable_navigator"),H.wcpFormShowControl("Image Map Settings","hold_ctrl_to_zoom")):(H.wcpFormHideControl("Image Map Settings","max_zoom"),H.wcpFormHideControl("Image Map Settings","limit_max_zoom_to_image_size"),H.wcpFormHideControl("Image Map Settings","enable_zoom_buttons"),H.wcpFormHideControl("Image Map Settings","enable_navigator"),H.wcpFormHideControl("Image Map Settings","hold_ctrl_to_zoom")),z(T.zooming.enable_zoom_buttons)&&z(T.zooming.enable_zooming)?(H.wcpFormShowControl("Image Map Settings","zoom_button_text_color"),H.wcpFormShowControl("Image Map Settings","zoom_button_background_color")):(H.wcpFormHideControl("Image Map Settings","zoom_button_text_color"),H.wcpFormHideControl("Image Map Settings","zoom_button_background_color")),z(T.layers.enable_layers)?(H.wcpFormShowControl("Image Map Settings","layers_list"),H.wcpFormHideControlsGroup("Image Map Settings","image")):(H.wcpFormHideControl("Image Map Settings","layers_list"),H.wcpFormShowControlsGroup("Image Map Settings","image")),z(T.shapes_menu.enable_shapes_menu)?(H.wcpFormShowControl("Image Map Settings","detached_menu"),H.wcpFormShowControl("Image Map Settings","menu_position"),H.wcpFormShowControl("Image Map Settings","enable_search"),H.wcpFormShowControl("Image Map Settings","group_by_floor"),H.wcpFormShowControl("Image Map Settings","hide_children_of_connected_shapes"),z(T.shapes_menu.detached_menu)?(H.wcpFormShowControl("Image Map Settings","detached_menu_info"),H.wcpFormHideControl("Image Map Settings","menu_position")):(H.wcpFormHideControl("Image Map Settings","detached_menu_info"),H.wcpFormShowControl("Image Map Settings","menu_position"))):(H.wcpFormHideControl("Image Map Settings","detached_menu"),H.wcpFormHideControl("Image Map Settings","menu_position"),H.wcpFormHideControl("Image Map Settings","detached_menu_info"),H.wcpFormHideControl("Image Map Settings","enable_search"),H.wcpFormHideControl("Image Map Settings","group_by_floor"),H.wcpFormHideControl("Image Map Settings","hide_children_of_connected_shapes")),z(T.shapes.glowing_shapes)?(H.wcpFormShowControl("Image Map Settings","glowing_shapes_color"),H.wcpFormShowControl("Image Map Settings","glow_opacity")):(H.wcpFormHideControl("Image Map Settings","glowing_shapes_color"),H.wcpFormHideControl("Image Map Settings","glow_opacity"))},l.prototype.updateNewImageMapFormState=function(){"blank"==H.wcpFormGetModel("New Image Map").template?H.wcpFormHideControl("New Image Map","country"):H.wcpFormShowControl("New Image Map","country")},l.prototype.parseSVG=function(t){var e=H.parseXML(t);T.general.width=parseInt(H(e).find("svg").attr("width"),10),T.general.height=parseInt(H(e).find("svg").attr("height"),10),T.general.naturalWidth=parseInt(H(e).find("svg").attr("width"),10),T.general.naturalHeight=parseInt(H(e).find("svg").attr("height"),10);for(var o=H(e).find("g"),i=0;i<o.length;i++){var r=H(o[i]);if(0==r.find("g").length){var s=r.find("rect, polygon, ellipse, circle, path"),a=0,n=0;if(r.attr("transform"))a=parseFloat(r.attr("transform").match(/\d+\.+\d+/g)[0]),n=parseFloat(r.attr("transform").match(/\d+\.+\d+/g)[1]);if(r.parent().is("svg"))for(var l=1;l<s.length;l++)this.parseSVGShape(H(s[l]),y,a,n);else{H(s[0]).attr("id",H(r).attr("id"));var p=this.parseSVGShape(H(s[0]),y,a,n);for(l=1;l<s.length;l++)H(s[l]).attr("id",H(r).attr("id")),this.parseSVGShape(H(s[l]),p,a,n)}}else for(s=r.children("rect, polygon, ellipse, circle, path"),l=0;l<s.length;l++){var d=s[l];this.parseSVGShape(H(d))}}},l.prototype.parseSVGShape=function(t,e,o,i){var r=0;if(t.is("polygon")){for(var s=t.attr("points").split(" "),a=[],n=0;n<s.length-2;n++)if(n%2==0){var l=parseFloat(s[n]),p=parseFloat(s[n+1]);a.push({x:l,y:p})}var d=_.createPoly(a);r=d.id,t.attr("id")&&(d.title=t.attr("id"),d.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.attr("id"))}if(t.is("rect")){var c=_.createRect();c.x=t.attr("x")/T.general.naturalWidth*100,c.y=t.attr("y")/T.general.naturalHeight*100,c.width=t.attr("width")/T.general.naturalWidth*100,c.height=t.attr("height")/T.general.naturalHeight*100,r=c.id,t.attr("id")&&(c.title=t.attr("id"),c.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.attr("id"))}if(t.is("circle")){var h=_.createOval();h.x=(t.attr("cx")-t.attr("r"))/T.general.naturalWidth*100,h.y=(t.attr("cy")-t.attr("r"))/T.general.naturalHeight*100,h.width=2*t.attr("r")/T.general.naturalWidth*100,h.height=2*t.attr("r")/T.general.naturalHeight*100,r=h.id,t.attr("id")&&(h.title=t.attr("id"),h.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.attr("id"))}if(t.is("ellipse")){var g=_.createOval();g.x=(t.attr("cx")-t.attr("rx"))/T.general.naturalWidth*100,g.y=(t.attr("cy")-t.attr("ry"))/T.general.naturalHeight*100,g.width=2*t.attr("rx")/T.general.naturalWidth*100,g.height=2*t.attr("ry")/T.general.naturalHeight*100,r=g.id,t.attr("id")&&(g.title=t.attr("id"),g.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.attr("id"))}if(t.is("path")){var m=_.createPath(t.attr("d"),e,o,i);r=m.id,t.attr("id")&&(m.title=t.attr("id"),m.tooltip_content.squares_settings.containers[0].settings.elements[0].options.heading.text=t.attr("id"))}return r},b.prototype.add=function(t){return new b(this.x+t.x,this.y+t.y)},b.prototype.subtract=function(t){return new b(this.x-t.x,this.y-t.y)},b.prototype.scale=function(t){return new b(this.x*t,this.y*t)},b.prototype.normalized=function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));return new b(this.x/t,this.y/t)},b.prototype.dot=function(t){return this.x*t.x+this.y*t.y},b.prototype.closestPointOnLine=function(t,e){function o(t,e){return Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)}var i=o(t,e);if(0==i)return o(this,v);var r=((this.x-t.x)*(e.x-t.x)+(this.y-t.y)*(e.y-t.y))/i;return r<0?t:1<r?e:new b(t.x+r*(e.x-t.x),t.y+r*(e.y-t.y))},b.prototype.vector2Args=function(t,e){return t=t||0,e=e||0,[this.x+t,this.y+e]}}(jQuery,window,document);